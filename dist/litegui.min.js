var LiteGUI={root:null,content:null,panels:{},windows:[],undo_steps:[],modalbg_div:null,mainmenu:null,init:function(t){if((t=t||{}).width&&t.height&&this.setWindowSize(t.width,t.height),this.container=null,t.container&&(this.container=document.getElementById(t.container)),this.container||(this.container=document.body),t.wrapped){var e=document.createElement("div");e.style.position="relative",e.style.overflow="hidden",this.root=e,this.container.appendChild(e);var i=document.createElement("div");this.content=i,this.root.appendChild(i),this.root.classList.contains("fullscreen")&&window.addEventListener("resize",function(t){LiteGUI.maximizeWindow()})}else this.root=this.content=this.container;this.root.className="litegui-wrap fullscreen",this.content.className="litegui-maincontent";var n=this.modalbg_div=document.createElement("div");this.modalbg_div.className="litemodalbg",this.root.appendChild(this.modalbg_div),n.style.display="none",t.menubar&&this.createMenubar(),t.gui_callback&&t.gui_callback(),window.addEventListener("beforeunload",function(t){for(var e in LiteGUI.windows)LiteGUI.windows[e].close();LiteGUI.windows=[]})},trigger:function(t,e,i,n){var o=document.createEvent("CustomEvent");return o.initCustomEvent(e,!0,!0,i),o.srcElement=n,t.dispatchEvent?t.dispatchEvent(o):t.__events&&t.__events.dispatchEvent(o),o},bind:function(t,i,n){if(!t)throw"Cannot bind to null";if(!i)throw"Event bind missing";if(!n)throw"Bind callback missing";if(t.constructor===String&&(t=document.querySelectorAll(t)),t.constructor===NodeList||t.constructor===Array)for(var e=0;e<t.length;++e)o(t[e]);else o(t);function o(t){if(t.addEventListener)t.addEventListener(i,n);else if(t.__events)t.__events.addEventListener(i,n);else{var e=document.createElement("span");e.widget=t,Object.defineProperty(t,"__events",{enumerable:!1,configurable:!1,writable:!1,value:e}),t.__events.addEventListener(i,n)}}},unbind:function(t,e,i){t.removeEventListener?t.removeEventListener(e,i):t.__events&&t.__events.removeEventListener&&t.__events.removeEventListener(e,i)},removeClass:function(t,e,i){i||(e="."+(i=e));for(var n=(t||document).querySelectorAll(e),o=0;o<n.length;++o)n[o].classList.remove(i)},add:function(t){this.content.appendChild(t.root||t)},remove:function(t){if(t){if(t.constructor===String)for(var e=document.querySelectorAll(t),i=0;i<e.length;++i){(t=e[i])&&t.parentNode&&t.parentNode.removeChild(t)}if(t.constructor===Array||t.constructor===NodeList)for(i=0;i<t.length;++i)LiteGUI.remove(t[i]);else t.root&&t.root.parentNode?t.root.parentNode.removeChild(t.root):t.parentNode&&t.parentNode.removeChild(t)}},getById:function(t){return document.getElementById(t)},createMenubar:function(){this.menubar=new LiteGUI.Menubar("mainmenubar"),this.add(this.menubar)},setWindowSize:function(t,e){var i=this.root.style;if(t&&e)i.width=t+"px",i.height=e+"px",i.boxShadow="0 0 4px black",this.root.classList.remove("fullscreen");else{if(this.root.classList.contains("fullscreen"))return;this.root.classList.add("fullscreen"),i.width="100%",i.height="100%",i.boxShadow="0 0 0"}LiteGUI.trigger(LiteGUI,"resized")},maximizeWindow:function(){this.setWindowSize()},setCursor:function(t){this.root.style.cursor=t},isCursorOverElement:function(t,e){var i=t.pageX,n=t.pageY,o=e.getBoundingClientRect();return!!o&&(n>o.top&&n<o.top+o.height&&i>o.left&&i<o.left+o.width)},getRect:function(t){return t.getBoundingClientRect()},toClipboard:function(e,t){e&&e.constructor!==String&&(e=JSON.stringify(e));var i=null,n=!1;if(!t)try{document.queryCommandSupported("copy");(i=document.createElement("input")).type="text",i.style.opacity=0,i.value=e,document.body.appendChild(i),i.select(),n=document.execCommand("copy"),console.log(n?"saved to clipboard":"problem saving to clipboard"),document.body.removeChild(i)}catch(t){i&&document.body.removeChild(i),console.warn("Oops, unable to copy using the true clipboard")}try{this._safe_cliboard=null,localStorage.setItem("litegui_clipboard",e)}catch(t){this._safe_cliboard=e,console.warn("cliboard quota excedeed")}},getLocalClipboard:function(){var t=localStorage.getItem("litegui_clipboard");return!t&&this._safe_cliboard&&(t=this._safe_cliboard),t?"{"==t[0]?JSON.parse(t):t:null},addCSS:function(t){if(t){if(t.constructor===String){var e=document.createElement("style");return e.type="text/css",e.innerHTML=t,void document.getElementsByTagName("head")[0].appendChild(e)}for(var i in t)document.body.style[i]=t[i]}},requireCSS:function(t,e){for("string"==typeof t&&(t=[t]);t.length;){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.href=t.shift(1),i.media="all",document.getElementsByTagName("head")[0].appendChild(i),0==t.length&&(i.onload=e)}},request:function(n){var t=n.dataType||"text";"json"==t||"xml"==t?t="text":"binary"==t&&(t="arraybuffer",n.mimeType="application/octet-stream");var o=new XMLHttpRequest;o.open(n.data?"POST":"GET",n.url,!0),t&&(o.responseType=t),n.mimeType&&o.overrideMimeType(n.mimeType),n.nocache&&o.setRequestHeader("Cache-Control","no-cache"),o.onload=function(t){var e=this.response;if(200!=this.status){var i="Error "+this.status;return n.error&&n.error(i),void LEvent.trigger(o,"fail",this.status)}if("json"==n.dataType)try{e=JSON.parse(e)}catch(i){if(!n.error)throw i;n.error(i)}else if("xml"==n.dataType)try{e=(new DOMParser).parseFromString(e,"text/xml")}catch(i){if(!n.error)throw i;n.error(i)}n.success&&n.success.call(this,e,this)},o.onerror=function(t){n.error&&n.error(t)};var e=new FormData;if(n.data)for(var i in n.data)e.append(i,n.data[i]);return o.send(e),o},requestText:function(t,e,i){return this.request({url:t,dataType:"text",success:e,error:i})},requestJSON:function(t,e,i){return this.request({url:t,dataType:"json",success:e,error:i})},requestBinary:function(t,e,i){return this.request({url:t,dataType:"binary",success:e,error:i})},requireScript:function(t,e,i,n,o){if(!t)throw"invalid URL";t.constructor===String&&(t=[t]);var r=t.length,s=[];for(var a in t){var l=document.createElement("script");l.num=a,l.type="text/javascript",l.src=t[a]+(o?"?version="+o:""),l.original_src=t[a],l.async=!1,l.onload=function(t){r--,s.push(this),r?n&&n(this.original_src,this.num):e&&e(s)},i&&(l.onerror=function(t){i(t,this.original_src,this.num)}),document.getElementsByTagName("head")[0].appendChild(l)}},requireScriptSerial:function(i,n,o){"string"==typeof i&&(i=[i]);var r=[];!function e(){var t=document.createElement("script");t.type="text/javascript",t.src=i.shift(1),t.onload=function(t){if(i.length)return o&&o(i[0],i.length),void e();r.push(this),n&&n(r)},document.getElementsByTagName("head")[0].appendChild(t)}()},newDiv:function(t,e){return this.createElement("div",t,e)},createElement:function(t,e,i,n,o){var r=document.createElement(t);if(e)for(var s=e.split(" "),a=0;a<s.length;a++)"."==s[a][0]?r.classList.add(s[a].substr(1)):"#"==s[a][0]?r.id=s[a].substr(1):r.id=s[a];if(r.root=r,i&&(r.innerHTML=i),r.add=function(t){this.appendChild(t.root||t)},n)if(n.constructor===String)r.setAttribute("style",n);else for(var a in n)r.style[a]=n[a];if(o)for(var a in o)r.addEventListener(a,o[a]);return r},createListItem:function(t,e,i){var n=document.createElement("span");if(n.innerHTML=t,n=n.childNodes[0],e)for(var o in e){var r=n.querySelector(o);r&&(r.innerText=e[o])}if(i)for(var o in i)n.style[o]=i[o];return n},createButton:function(t,e,i,n){var o=document.createElement("button");if(o.className="litegui litebutton button",t)for(var r=t.split(" "),s=0;s<r.length;s++)"."==r[s][0]?o.classList.add(r[s].substr(1)):"#"==r[s][0]?o.id=r[s].substr(1):o.id=r[s];if(o.root=o,void 0!==e&&(o.innerHTML=e),i&&o.addEventListener("click",i),n)if(n.constructor===String)o.setAttribute("style",n);else for(var s in n)o.style[s]=n[s];return o},getParents:function(t){for(var e=[];null!==(t=t.parentElement);)t.nodeType===Node.ELEMENT_NODE&&e.push(elem);return e},newWindow:function(t,e,i,n){n=n||{};var o=window.open("","","width="+e+", height="+i+", location=no, status=no, menubar=no, titlebar=no, fullscreen=yes");o.document.write("<html><head><title>"+t+"</title>");for(var r=document.querySelectorAll("link[rel='stylesheet'],style"),s=0;s<r.length;s++)o.document.write(r[s].outerHTML);if(n.scripts){var a=document.querySelectorAll("script");for(s=0;s<a.length;s++)a[s].src&&o.document.write(a[s].outerHTML)}var l=n.content||"";return o.document.write("</head><body>"+l+"</body></html>"),o.document.close(),o},showModalBackground:function(t){LiteGUI.modalbg_div&&(LiteGUI.modalbg_div.style.display=t?"block":"none")},showMessage:function(t,e){(e=e||{}).title=e.title||"Attention",e.content=t,e.close="fade";var i=new LiteGUI.Dialog(e);return e.noclose||i.addButton("Close",{close:!0}),i.makeModal("fade"),i},popup:function(t,e){(e=e||{}).min_height=140,"string"==typeof t&&(t="<p>"+t+"</p>"),e.content=t,e.close="fade";var i=new LiteGUI.Dialog(e);return e.noclose||i.addButton("Close",{close:!0}),i.show(),i},alert:function(t,e){return(e=e||{}).className="alert",e.title=e.title||"Alert",e.width=e.width||280,e.height=e.height||140,"string"==typeof t&&(t="<p>"+t+"</p>"),LiteGUI.remove(".litepanel.alert"),LiteGUI.showMessage(t,e)},confirm:function(t,e,i){(i=i||{}).className="alert",i.title=i.title||"Confirm",i.width=i.width||280,"string"==typeof t&&(t="<p>"+t+"</p>"),t+="<button class='litebutton' data-value='yes' style='width:45%; margin-left: 10px'>Yes</button><button class='litebutton' data-value='no' style='width:45%'>No</button>",i.noclose=!0;var n=this.showMessage(t,i);n.content.style.paddingBottom="10px";for(var o=n.content.querySelectorAll("button"),r=0;r<o.length;r++)o[r].addEventListener("click",s);function s(t){t="yes"==this.dataset.value;n.close(),e&&e(t)}return o[0].focus(),n},prompt:function(t,e,i){(i=i||{}).className="alert",i.title=i.title||"Prompt",i.width=i.width||280,"string"==typeof t&&(t="<p>"+t+"</p>");var n=i.value||"",o="<input type='text' value='"+n+"'/>";i.textarea&&(o="<textarea class='textfield' style='width:95%'>"+n+"</textarea>"),t+="<p>"+o+"</p><button class='litebutton' data-value='accept' style='width:45%; margin-left: 10px; margin-bottom: 10px'>Accept</button><button class='litebutton' data-value='cancel' style='width:45%'>Cancel</button>",i.noclose=!0;for(var r=this.showMessage(t,i),s=r.content.querySelectorAll("button"),a=0;a<s.length;a++)s[a].addEventListener("click",c);var l=r.content.querySelector("input,textarea");function c(){var t=l.value;this.dataset&&"cancel"==this.dataset.value&&(t=null),r.close(),e&&e(t)}return l.addEventListener("keydown",function(t){t=t||window.event;var e=t.keyCode||t.which;if("13"==e)return c(),!1;"29"==e&&r.close()},!0),l.focus(),r},choice:function(t,e,i,n){for(var o in(n=n||{}).className="alert",n.title=n.title||"Select one option",n.width=n.width||280,"string"==typeof t&&(t="<p>"+t+"</p>"),e)t+="<button class='litebutton' data-value='"+o+"' style='width:45%; margin-left: 10px'>"+(e[o].content||e[o])+"</button>";n.noclose=!0;var r=this.showMessage(t,n);r.content.style.paddingBottom="10px";var s=r.content.querySelectorAll("button");for(o=0;o<s.length;o++)s[o].addEventListener("click",a);function a(t){t=e[this.dataset.value];r.close(),i&&i(t)}return r},downloadURL:function(t,e){var i=document.createElement("a");i.href=t,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i)},downloadFile:function(t,e,i){if(e){i=i||(e.constructor===String?"text/plain":"application/octet-stream");var n=null;n=e.constructor!==File&&e.constructor!==Blob?new Blob([e],{type:i}):e;var o=URL.createObjectURL(n),r=document.createElement("a");r.setAttribute("href",o),r.setAttribute("download",t),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),setTimeout(function(){URL.revokeObjectURL(o)},6e4)}else console.warn("No file provided to download")},getUrlVars:function(){for(var t,e=[],i=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),n=0;n<i.length;n++)t=i[n].split("="),e.push(t[0]),e[t[0]]=t[1];return e},getUrlVar:function(t){return LiteGUI.getUrlVars()[t]},focus:function(t){t.focus()},blur:function(t){t.blur()},draggable:function(o,t,r,s,a){(t=t||o).addEventListener("mousedown",function t(e){if("mousedown"==e.type)return d||(d=o.getClientRects()[0],u=d?d.left:0,h=d?d.top:0),a&&0==a(o,e)||(l=e.clientX,c=e.clientY,document.addEventListener("mousemove",t),document.addEventListener("mouseup",t),r&&r(o,e)),e.stopPropagation(),e.preventDefault(),!1;if("mouseup"==e.type)return document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",t),void(s&&s(o,e));if("mousemove"==e.type){var i=e.clientX-l,n=e.clientY-c;l=e.clientX,c=e.clientY,u+=i,h+=n,o.style.left=u+"px",o.style.top=h+"px"}}),t.style.cursor="move";var l=0,c=0,d=o.getClientRects()[0],u=d?d.left:0,h=d?d.top:0;o.style.position="absolute",o.style.left=u+"px",o.style.top=h+"px"},cloneObject:function(t,e){var i=e||{};for(var n in t)if("_"!=n[0]&&"jQuery"!=n.substr(0,6)){var o=t[n];if(null==o)i[n]=null;else{if(isFunction(o))continue;if("number"==typeof o||"string"==typeof o)i[n]=o;else if(o.constructor==Float32Array)i[n]=Array.apply([],o);else if(isArray(o))i[n]&&i[n].constructor==Float32Array?i[n].set(o):i[n]=JSON.parse(JSON.stringify(o));else try{i[n]=JSON.parse(JSON.stringify(o))}catch(t){console.error(t)}}}return i},safeName:function(t){return String(t).replace(/[\s\.]/g,"")},special_codes:{close:"&#10005;",navicon:"&#9776;",refresh:"&#8634;",gear:"&#9881;",open_folder:"&#128194;",download:"&#11123;",tick:"&#10003;",trash:"&#128465;"},htmlEncode:function(t){var e=document.createElement("div");return e.innerHTML=t,e.innerText},htmlDecode:function(t){var e=document.createElement("div");return e.innerText=t,e.innerHTML},sizeToCSS:function(t){return null==t?null:t.constructor===String?t:0<=t?(0|t)+"px":"calc( 100% - "+Math.abs(0|t)+"px )"},getElementWindow:function(t){var e=t.ownerDocument;return e.defaultView||e.parentWindow},createDropArea:function(i,n,e,o){function r(t){i.addEventListener("dragexit",r),i.addEventListener("dragover",r),i.addEventListener("drop",s),t.stopPropagation(),t.preventDefault(),"dragenter"==t.type&&e&&e(t,this),"dragexit"==t.type&&o&&o(t,this)}function s(t){t.stopPropagation(),t.preventDefault(),i.removeEventListener("dragexit",r),i.removeEventListener("dragover",r),i.removeEventListener("drop",s);var e=void 0;if(n&&(e=n(t)),e)return t.stopPropagation(),t.stopImmediatePropagation(),!0}i.addEventListener("dragenter",r)}};function purgeElement(t,e){var i,n,o,r=t.attributes;if(r)for(i=r.length-1;0<=i;--i)"function"==typeof t[o=r[i].name]&&(t[o]=null);if(r=t.childNodes)for(n=r.length,i=0;i<n;i+=1)purgeElement(t.childNodes[i])}function beautifyCode(t,e,i){return e=e||["abstract","else","instanceof","super","boolean","enum","int","switch","break","export","interface","synchronized","byte","extends","let","this","case","false","long","throw","catch","final","native","throws","char","finally","new","transient","class","float","null","true","const","for","package","try","continue","function","private","typeof","debugger","goto","protected","var","default","if","public","void","delete","implements","return","volatile","do","import","short","while","double","in","static","with"],t=(t=(t=(t=(t=(t=t.replace(/\b(\w+)\b/g,function(t){return-1!=e.indexOf(t)?"<span class='rsv'>"+t+"</span>":t})).replace(/\b([0-9]+)\b/g,function(t){return"<span class='num'>"+t+"</span>"})).replace(/(\w+\.\w+)/g,function(t){var e=t.split(".");return"<span class='obj'>"+e[0]+"</span>.<span class='prop'>"+e[1]+"</span>"})).replace(/(\w+)\(/g,function(t){return"<span class='prop'>"+t.substr(0,t.length-1)+"</span>("})).replace(/(\"(\\.|[^\"])*\")/g,function(t){return"<span class='str'>"+t+"</span>"})).replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,function(t){return"<span class='cmnt'>"+t.replace(/<[^>]*>/g,"")+"</span>"}),i||(t="<style>.obj { color: #79B; } .prop { color: #B97; }\t.str,.num { color: #A79; } .cmnt { color: #798; } .rsv { color: #9AB; } </style>"+t),t}function beautifyJSON(t,e){"object"==typeof t&&(t=JSON.stringify(t));var i=["false","true","null"];return t=(t=(t=(t=(t=t.replace(/(\w+)/g,function(t){return-1!=i.indexOf(t)?"<span class='rsv'>"+t+"</span>":t})).replace(/([0-9]+)/g,function(t){return"<span class='num'>"+t+"</span>"})).replace(/(\w+\.\w+)/g,function(t){var e=t.split(".");return"<span class='obj'>"+e[0]+"</span>.<span class='prop'>"+e[1]+"</span>"})).replace(/(\"(\\.|[^\"])*\")/g,function(t){return"<span class='str'>"+t+"</span>"})).replace(/(\/\/[a-zA-Z0-9\?\!\(\)_ ]*)/g,function(t){return"<span class='cmnt'>"+t+"</span>"}),e||(t="<style>.obj { color: #79B; } .prop { color: #B97; }\t.str { color: #A79; } .num { color: #B97; } .cmnt { color: #798; } .rsv { color: #9AB; } </style>"+t),t}function dataURItoBlob(t){for(var e=t.indexOf(","),i=atob(t.substr(e+1)),n=new ArrayBuffer(i.length),o=new Uint8Array(n),r=i.length,s=0;s<r;s++)o[s]=i.charCodeAt(s);var a=t.substr(5,e-5);return a=a.substr(0,a.length-7),new Blob([n],{type:a})}function Inspector(t){if(t&&t.constructor===String){var e=t;(t=arguments[1]||{}).id=e,console.warn("LiteGUI.Inspector legacy parameter, use options as first parameter instead of id.")}t=t||{},this.root=document.createElement("DIV"),this.root.className="inspector "+(t.full?"full":"")+(t.className||""),t.one_line&&(this.one_line=!0,this.root.className+=" one_line"),t.id&&(this.root.id=t.id),this.sections=[],this.values={},this.widgets=[],this.widgets_by_name={},this.row_number=0,this.addContainer(),this.tab_index=Math.floor(1e4*Math.random()),t.width&&(this.root.style.width=LiteGUI.sizeToCSS(t.width)),t.height&&(this.root.style.height=LiteGUI.sizeToCSS(t.height),t.one_line||(this.root.style.overflow="auto")),t.name_width&&(this.name_width=t.name_width),t.widgets_width&&(this.widgets_width=t.widgets_width),t.noscroll&&(this.root.style.overflow="hidden"),t.onchange&&(this.onchange=t.onchange),t.parent&&this.appendTo(t.parent),this.className=this.root.className,this.widgets_per_row=t.widgets_per_row||1}Object.defineProperty(String.prototype,"template",{value:function(t,e){for(var i,n=this,o=/{{([^}}]+)?}}/g;i=o.exec(n);){var r=e?new Function("with(this) { try { return "+i[1]+"} catch(e) { return 'error';} }").call(t):t[i[1]];n=n.replace(i[0],r)}return n},enumerable:!1}),"undefined"==typeof escapeHtmlEntities&&(escapeHtmlEntities=function(t){return t.replace(/[\u00A0-\u2666<>\&]/g,function(t){return"&"+(escapeHtmlEntities.entityTable[t.charCodeAt(0)]||"#"+t.charCodeAt(0))+";"})},escapeHtmlEntities.entityTable={34:"quot",38:"amp",39:"apos",60:"lt",62:"gt",160:"nbsp",161:"iexcl",162:"cent",163:"pound",164:"curren",165:"yen",166:"brvbar",167:"sect",168:"uml",169:"copy",170:"ordf",171:"laquo",172:"not",173:"shy",174:"reg",175:"macr",176:"deg",177:"plusmn",178:"sup2",179:"sup3",180:"acute",181:"micro",182:"para",183:"middot",184:"cedil",185:"sup1",186:"ordm",187:"raquo",188:"frac14",189:"frac12",190:"frac34",191:"iquest",192:"Agrave",193:"Aacute",194:"Acirc",195:"Atilde",196:"Auml",197:"Aring",198:"AElig",199:"Ccedil",200:"Egrave",201:"Eacute",202:"Ecirc",203:"Euml",204:"Igrave",205:"Iacute",206:"Icirc",207:"Iuml",208:"ETH",209:"Ntilde",210:"Ograve",211:"Oacute",212:"Ocirc",213:"Otilde",214:"Ouml",215:"times",216:"Oslash",217:"Ugrave",218:"Uacute",219:"Ucirc",220:"Uuml",221:"Yacute",222:"THORN",223:"szlig",224:"agrave",225:"aacute",226:"acirc",227:"atilde",228:"auml",229:"aring",230:"aelig",231:"ccedil",232:"egrave",233:"eacute",234:"ecirc",235:"euml",236:"igrave",237:"iacute",238:"icirc",239:"iuml",240:"eth",241:"ntilde",242:"ograve",243:"oacute",244:"ocirc",245:"otilde",246:"ouml",247:"divide",248:"oslash",249:"ugrave",250:"uacute",251:"ucirc",252:"uuml",253:"yacute",254:"thorn",255:"yuml",402:"fnof",913:"Alpha",914:"Beta",915:"Gamma",916:"Delta",917:"Epsilon",918:"Zeta",919:"Eta",920:"Theta",921:"Iota",922:"Kappa",923:"Lambda",924:"Mu",925:"Nu",926:"Xi",927:"Omicron",928:"Pi",929:"Rho",931:"Sigma",932:"Tau",933:"Upsilon",934:"Phi",935:"Chi",936:"Psi",937:"Omega",945:"alpha",946:"beta",947:"gamma",948:"delta",949:"epsilon",950:"zeta",951:"eta",952:"theta",953:"iota",954:"kappa",955:"lambda",956:"mu",957:"nu",958:"xi",959:"omicron",960:"pi",961:"rho",962:"sigmaf",963:"sigma",964:"tau",965:"upsilon",966:"phi",967:"chi",968:"psi",969:"omega",977:"thetasym",978:"upsih",982:"piv",8226:"bull",8230:"hellip",8242:"prime",8243:"Prime",8254:"oline",8260:"frasl",8472:"weierp",8465:"image",8476:"real",8482:"trade",8501:"alefsym",8592:"larr",8593:"uarr",8594:"rarr",8595:"darr",8596:"harr",8629:"crarr",8656:"lArr",8657:"uArr",8658:"rArr",8659:"dArr",8660:"hArr",8704:"forall",8706:"part",8707:"exist",8709:"empty",8711:"nabla",8712:"isin",8713:"notin",8715:"ni",8719:"prod",8721:"sum",8722:"minus",8727:"lowast",8730:"radic",8733:"prop",8734:"infin",8736:"ang",8743:"and",8744:"or",8745:"cap",8746:"cup",8747:"int",8756:"there4",8764:"sim",8773:"cong",8776:"asymp",8800:"ne",8801:"equiv",8804:"le",8805:"ge",8834:"sub",8835:"sup",8836:"nsub",8838:"sube",8839:"supe",8853:"oplus",8855:"otimes",8869:"perp",8901:"sdot",8968:"lceil",8969:"rceil",8970:"lfloor",8971:"rfloor",9001:"lang",9002:"rang",9674:"loz",9824:"spades",9827:"clubs",9829:"hearts",9830:"diams",338:"OElig",339:"oelig",352:"Scaron",353:"scaron",376:"Yuml",710:"circ",732:"tilde",8194:"ensp",8195:"emsp",8201:"thinsp",8204:"zwnj",8205:"zwj",8206:"lrm",8207:"rlm",8211:"ndash",8212:"mdash",8216:"lsquo",8217:"rsquo",8218:"sbquo",8220:"ldquo",8221:"rdquo",8222:"bdquo",8224:"dagger",8225:"Dagger",8240:"permil",8249:"lsaquo",8250:"rsaquo",8364:"euro"}),function(){function t(t,i){i=i||{},t=t||"";var e=document.createElement("div");e.className="litegui searchbox";var n=null!=i.placeholder?i.placeholder:"Search";e.innerHTML="<input value='"+t+"' placeholder='"+n+"'/>",this.input=e.querySelector("input"),this.root=e;var o=this;this.input.onchange=function(t){var e=t.target.value;i.callback&&i.callback.call(o,e)}}function e(t,e){e=e||{},this.options=e;var i=this;e.parentMenu&&(e.parentMenu.constructor!==this.constructor?(console.error("parentMenu must be of class ContextMenu, ignoring it"),e.parentMenu=null):(this.parentMenu=e.parentMenu,this.parentMenu.lock=!0,this.parentMenu.current_submenu=this)),e.event&&"MouseEvent"!==e.event.constructor.name&&"PointerEvent"!==e.event.constructor.name&&"CustomEvent"!==e.event.constructor.name&&(console.error("Event passed to ContextMenu is not of type MouseEvent or CustomEvent. Ignoring it."),e.event=null);var n=document.createElement("div");if(n.className="litecontextmenu litemenubar-panel",n.style.minWidth=100,n.style.minHeight=100,n.style.pointerEvents="none",setTimeout(function(){n.style.pointerEvents="auto"},100),n.addEventListener("mouseup",function(t){return t.preventDefault(),!0},!0),n.addEventListener("contextmenu",function(t){return 2!=t.button||t.preventDefault(),!1},!0),n.addEventListener("mousedown",function(t){if(2==t.button)return i.close(),t.preventDefault(),!0},!0),this.root=n,e.title){var o=document.createElement("div");o.className="litemenu-title",o.innerHTML=e.title,n.appendChild(o)}for(var r in t){var s=t.constructor==Array?t[r]:r;null!=s&&s.constructor!==String&&(s=void 0===s.content?String(s):s.content);var a=t[r];this.addItem(s,a,e),0}function l(t){var e=parseInt(n.style.top);return n.style.top=(e+.1*t.deltaY).toFixed()+"px",t.preventDefault(),!0}n.addEventListener("mouseleave",function(t){i.lock||(n.closing_timer&&clearTimeout(n.closing_timer),n.closing_timer=setTimeout(i.close.bind(i,t),500))}),n.addEventListener("mouseenter",function(t){n.closing_timer&&clearTimeout(n.closing_timer)}),n.addEventListener("wheel",l,!0),n.addEventListener("mousewheel",l,!0);var c=document;e.event&&(c=e.event.target.ownerDocument),(c=c||document).body.appendChild(n);var d=e.left||0,u=e.top||0;if(e.event)if("MouseEvent"!==e.event.constructor.name&&"PointerEvent"!==e.event.constructor.name&&"CustomEvent"!==e.event.constructor.name)console.warn("Event passed to ContextMenu is not of type MouseEvent"),e.event=null;else{if(d=e.event.pageX-10,u=e.event.pageY-10,e.title&&(u-=20),e.parentMenu){var h=e.parentMenu.root.getBoundingClientRect();d=h.left+h.width}var p=document.body.getBoundingClientRect(),f=n.getBoundingClientRect();d>p.width-f.width-10&&(d=p.width-f.width-10),u>p.height-f.height-10&&(u=p.height-f.height-10)}n.style.left=d+"px",n.style.top=u+"px"}function i(t,e,i){i=i||{};var n=this.root=document.createElement("ul");n.id=t,n.className="litelist",this.items=[];var o=this;for(var r in this.callback=i.callback,e){var s=document.createElement("li");s.className="list-item",s.data=e[r],s.dataset.value=e[r];var a="";"string"==typeof e[r]?a=e[r]+"<span class='arrow'></span>":(a=(e[r].name||e[r].title||"")+"<span class='arrow'></span>",e[r].id&&(s.id=e[r].id)),s.innerHTML=a,s.addEventListener("click",function(){for(var t=n.querySelectorAll(".list-item.selected"),e=0;e<t.length;++e)t[e].classList.remove("selected");this.classList.add("selected"),LiteGUI.trigger(o.root,"wchanged",this),o.callback&&o.callback(this.data)}),n.appendChild(s)}i.parent&&(i.parent.root?i.parent.root.appendChild(n):i.parent.appendChild(n))}function n(t){t=t||{},this.root=document.createElement("div"),this.root.className="litecomplexlist",this.item_code=t.item_code||"<div class='listitem'><span class='tick'><span>"+LiteGUI.special_codes.tick+"</span></span><span class='title'></span><button class='trash'>"+LiteGUI.special_codes.close+"</button></div>",t.height&&(this.root.style.height=LiteGUI.sizeToCSS(t.height)),this.selected=null,this.onItemSelected=null,this.onItemToggled=null,this.onItemRemoved=null}LiteGUI.Button=function(t,e){"function"==typeof(e=e||{})&&(e={callback:e});var i=this,n=document.createElement("div");n.className="litegui button",this.root=n;var o=document.createElement("button");o.className="litebutton",this.content=o,n.appendChild(o),o.innerHTML=t,o.addEventListener("click",function(t){i.click()}),this.click=function(){e.callback&&e.callback.call(i)}},t.prototype.setValue=function(t){this.input.value=t,this.input.onchange()},t.prototype.getValue=function(){return this.input.value},LiteGUI.SearchBox=t,e.prototype.addItem=function(t,e,n){var o=this;n=n||{};var i=document.createElement("div"),r=!(i.className="litemenu-entry submenu");function s(t){var e=this.value,i=!0;o.current_submenu&&o.current_submenu.close(t),!n.callback||!0===n.callback.call(o,e,n,t)&&(i=!1);if(e){if(e.callback&&!n.ignore_item_callbacks&&!0!==e.disabled)!0===e.callback.call(this,e,n,t,o)&&(i=!1);if(e.submenu){if(!e.submenu.options)throw"ContextMenu submenu needs options";new LiteGUI.ContextMenu(e.submenu.options,{callback:e.submenu.callback,event:t,parentMenu:o,ignore_item_callbacks:e.submenu.ignore_item_callbacks,title:e.submenu.title,autoopen:n.autoopen});i=!1}}i&&!o.lock&&o.close()}return null===e?i.classList.add("separator"):(i.innerHTML=e&&e.title?e.title:t,(i.value=e)&&(e.disabled&&(r=!0,i.classList.add("disabled")),(e.submenu||e.has_submenu)&&i.classList.add("has_submenu")),"function"==typeof e?(i.dataset.value=t,i.onclick_callback=e):i.dataset.value=e),this.root.appendChild(i),r||i.addEventListener("click",s),n.autoopen&&i.addEventListener("mouseenter",function(t){var e=this.value;if(!e||!e.has_submenu)return;s.call(this,t)}),i},e.prototype.close=function(t,e){this.root.parentNode&&this.root.parentNode.removeChild(this.root),this.parentMenu&&!e&&(this.parentMenu.lock=!1,this.parentMenu.current_submenu=null,void 0===t?this.parentMenu.close():t&&!LiteGUI.isCursorOverElement(t,this.parentMenu.root)&&LiteGUI.trigger(this.parentMenu.root,"mouseleave",t)),this.current_submenu&&this.current_submenu.close(t,!0),this.root.closing_timer&&clearTimeout(this.root.closing_timer)},e.prototype.getTopMenu=function(){return this.options.parentMenu?this.options.parentMenu.getTopMenu():this},e.prototype.getFirstEvent=function(){return this.options.parentMenu?this.options.parentMenu.getFirstEvent():this.options.event},LiteGUI.ContextMenu=e,LiteGUI.ContextualMenu=e,LiteGUI.Checkbox=function(t,i){this.value=t;var e=this.root=document.createElement("span");e.className="litecheckbox inputfield",e.dataset.value=t;var n=this.element=document.createElement("span");n.className="fixed flag checkbox "+(t?"on":"off"),e.appendChild(n),e.addEventListener("click",function(t){this.setValue("true"!=this.root.dataset.value),t.preventDefault(),t.stopPropagation()}.bind(this)),this.setValue=function(t){if(this.value!==t&&this.root.dataset.value!=t.toString()){(this.root.dataset.value=t)?(this.element.classList.remove("off"),this.element.classList.add("on")):(this.element.classList.remove("on"),this.element.classList.add("off"));var e=this.value;this.value=t,i&&i(t,e)}},this.getValue=function(){return this.value}},LiteGUI.createLitebox=function(t,e){var i=document.createElement("span");return i.className="listbox "+(t?"listopen":"listclosed"),i.innerHTML=t?"&#9660;":"&#9658;",i.dataset.value=t?"open":"closed",i.addEventListener("click",function(t){t.target.setValue("open"!=this.dataset.value),this.stopPropagation&&t.stopPropagation()}),i.on_change_callback=e,i.setEmpty=function(t){t?this.classList.add("empty"):this.classList.remove("empty")},i.expand=function(){this.setValue(!0)},i.collapse=function(){this.setValue(!1)},i.setValue=function(t){this.dataset.value!=(t?"open":"closed")&&(t?(this.dataset.value="open",this.innerHTML="&#9660;",this.classList.add("listopen"),this.classList.remove("listclosed")):(this.dataset.value="closed",this.innerHTML="&#9658;",this.classList.remove("listopen"),this.classList.add("listclosed")),e&&e(this.dataset.value))},i.getValue=function(){return this.dataset.value},i},i.prototype.getSelectedItem=function(){return this.root.querySelector(".list-item.selected")},i.prototype.setSelectedItem=function(t){for(var e=this.root.querySelectorAll(".list-item"),i=0;i<e.length;i++){var n=e[i];if(n.data==t){LiteGUI.trigger(n,"click");break}}},LiteGUI.List=i,LiteGUI.Slider=function(t,a){a=a||{};var l=this.root=document.createElement("div"),r=this;function i(t){var e=l.getBoundingClientRect();if(e){var i=t/e.width,n=a.min||0,o=(a.max||1)-n;r.setValue(o*i+n)}}this.value=t,l.className="liteslider",this.setValue=function(t,e){var i=a.min||0,n=a.max||1;t<i?t=i:n<t&&(t=n);var o=(t-i)/(n-i),r=(100*o).toFixed(1)+"%",s=(100*o+2).toFixed(1)+"%";l.style.background="linear-gradient(to right, #999 "+r+", #FC0 "+s+", #333 "+s+")",t!=this.value&&(this.value=t,e||(LiteGUI.trigger(this.root,"change",t),this.onChange&&this.onChange(t)))};var n=null;function o(t){var e=l.getBoundingClientRect();if(e)return i((void 0===t.x?t.pageX:t.x)-e.left),t.preventDefault(),!1}function s(t){var e=n||document;return n=null,e.removeEventListener("mousemove",o),e.removeEventListener("mouseup",s),t.preventDefault(),!1}l.addEventListener("mousedown",function(t){var e;t.offsetX?(e=t.offsetX,t.offsetY):t.layerX&&(e=t.layerX,t.layerY),i(e),(n=l.ownerDocument).addEventListener("mousemove",o),n.addEventListener("mouseup",s),t.preventDefault(),t.stopPropagation()}),this.setValue(t)},LiteGUI.LineEditor=function(t,e){e=e||{};var l=document.createElement("div");l.className="curve "+(e.extraclass?e.extraclass:""),l.style.minHeight="50px",l.style.width=e.width||"100%",l.bgcolor=e.bgcolor||"#222",l.pointscolor=e.pointscolor||"#5AF",l.linecolor=e.linecolor||"#444",l.value=t||[],l.xrange=e.xrange||[0,1],l.yrange=e.yrange||[0,1],l.defaulty=null!=e.defaulty?e.defaulty:.5,l.no_trespassing=e.no_trespassing||!1,l.show_samples=e.show_samples||0,l.options=e,l.style.minWidth="50px",l.style.minHeight="20px";var c=document.createElement("canvas");function a(t){return[c.width*((l.xrange[1]-l.xrange[0])*t[0]+l.xrange[0]),c.height*((l.yrange[1]-l.yrange[0])*t[1]+l.yrange[0])]}function d(t){return[(t[0]/c.width-l.xrange[0])/(l.xrange[1]-l.xrange[0]),(t[1]/c.height-l.yrange[0])/(l.yrange[1]-l.yrange[0])]}c.width=e.width||200,c.height=e.height||50,l.appendChild(c),l.canvas=c,l.addEventListener("mousedown",function(t){document.addEventListener("mousemove",r),document.addEventListener("mouseup",p);var e=c.getBoundingClientRect(),i=t.clientX-e.left,n=t.clientY-e.top;if(-1==(u=function(t,e){for(var i=1e5,n=-1,o=0;o<l.value.length;o++){var r=a(l.value[o]),s=g([t,e],r);s<i&&s<8&&(i=s,n=o)}return n}(i,c.height-n))){var o=d([i,c.height-n]);l.value.push(o),v(),u=l.value.indexOf(o)}h=[i,n],l.redraw(),t.preventDefault(),t.stopPropagation()}),l.getValueAt=function(t){if(t<l.xrange[0]||t>l.xrange[1])return l.defaulty;for(var e=[l.xrange[0],l.defaulty],i=0,n=0;n<l.value.length;n+=1){var o=l.value[n];if(t==o[0])return o[1];if(t<o[0])return i=(t-e[0])/(o[0]-e[0]),e[1]*(1-i)+o[1]*i;e=o}return o=[l.xrange[1],l.defaulty],i=(t-e[0])/(o[0]-e[0]),e[1]*(1-i)+o[1]*i},l.resample=function(t){for(var e=[],i=(l.xrange[1]-l.xrange[0])/t,n=l.xrange[0];n<=l.xrange[1];n+=i)e.push(l.getValueAt(n));return e},l.addValue=function(t){for(var e=0;e<l.value;e++){if(!(l.value[e][0]<t[0]))return l.value.splice(e,0,t),void redraw()}l.value.push(t),redraw()};var u=-1;l.redraw=function(){var t=c.parentNode.getBoundingClientRect();t&&c.width!=t.width&&t.width&&t.width<1e3&&(c.width=t.width),t&&c.height!=t.height&&t.height&&t.height<1e3&&(c.height=t.height);var e=c.getContext("2d");e.setTransform(1,0,0,1,0,0),e.translate(0,c.height),e.scale(1,-1),e.fillStyle=l.bgcolor,e.fillRect(0,0,c.width,c.height),e.strokeStyle=l.linecolor,e.beginPath();var i=a([l.xrange[0],l.defaulty]);for(var n in e.moveTo(i[0],i[1]),l.value){i=a(l.value[n]),e.lineTo(i[0],i[1])}i=a([l.xrange[1],l.defaulty]),e.lineTo(i[0],i[1]),e.stroke();for(n=0;n<l.value.length;n+=1){i=a(l.value[n]),e.fillStyle=u==n?"white":l.pointscolor,e.beginPath(),e.arc(i[0],i[1],u==n?4:2,0,2*Math.PI),e.fill()}if(l.show_samples){var o=l.resample(l.show_samples);e.fillStyle="#888";for(n=0;n<o.length;n+=1){i=a([n*((l.xrange[1]-l.xrange[0])/l.show_samples)+l.xrange[0],o[n]]),e.beginPath(),e.arc(i[0],i[1],2,0,2*Math.PI),e.fill()}}};var h=[0,0];function r(t){var e=c.getBoundingClientRect(),i=t.clientX-e.left,n=t.clientY-e.top;if(i<0?i=0:i>c.width&&(i=c.width),n<0?n=0:n>c.height&&(n=c.height),-1!=u&&g([t.clientX-e.left,t.clientY-e.top],[i,n])>.5*c.height)return l.value.splice(u,1),void p(t);var o=d([-(h[0]-i),h[1]-n]);if(-1!=u){var r=l.xrange[0],s=l.xrange[1];l.no_trespassing&&(0<u&&(r=l.value[u-1][0]),u<l.value.length-1&&(s=l.value[u+1][0]));var a=l.value[u];a[0]+=o[0],a[1]+=o[1],a[0]<r?a[0]=r:a[0]>s&&(a[0]=s),a[1]<l.yrange[0]?a[1]=l.yrange[0]:a[1]>l.yrange[1]&&(a[1]=l.yrange[1])}v(),l.redraw(),h[0]=i,h[1]=n,f(),t.preventDefault(),t.stopPropagation()}function p(t){u=-1,l.redraw(),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",p),f(),t.preventDefault(),t.stopPropagation()}function f(){e.callback?e.callback.call(l,l.value):LiteGUI.trigger(l,"change")}function g(t,e){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}function v(){var t=null;-1!=u&&(t=l.value[u]),l.value.sort(function(t,e){return t[0]-e[0]}),t&&(u=l.value.indexOf(t))}return l.redraw(),l},n.prototype.addTitle=function(t){var e=LiteGUI.createElement("div",".listtitle",t);return this.root.appendChild(e),e},n.prototype.addHTML=function(t,e){var i=LiteGUI.createElement("div",".listtext",t);return e&&i.addEventListener("mousedown",e),this.root.appendChild(i),i},n.prototype.clear=function(){this.root.innerHTML=""},n.prototype.addItem=function(e,t,i,n){var o=t||e.content||e.name,r=LiteGUI.createListItem(this.item_code,{".title":o});r.item=e,i&&r.classList.add("enabled"),n||(r.querySelector(".trash").style.display="none");var s=this;return r.addEventListener("mousedown",function(t){t.preventDefault(),this.setSelected(!0),s.onItemSelected&&s.onItemSelected(e,r)}),r.querySelector(".tick").addEventListener("mousedown",function(t){t.preventDefault(),r.classList.toggle("enabled"),s.onItemToggled&&s.onItemToggled(e,r,r.classList.contains("enabled"))}),r.querySelector(".trash").addEventListener("mousedown",function(t){t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),s.onItemRemoved&&s.onItemRemoved(e,r)}),r.setContent=function(t,e){e?r.querySelector(".title").innerHTML=t:r.querySelector(".title").innerText=t},r.toggleEnabled=function(t){r.classList.toggle("enabled")},r.setSelected=function(t){LiteGUI.removeClass(s.root,"selected"),t?this.classList.add("selected"):this.classList.remove("selected"),s.selected=r.item},r.show=function(){this.style.display=""},r.hide=function(){this.style.display="none"},this.root.appendChild(r),r},LiteGUI.ComplexList=n}(),function(){function t(t){t=t||{},this.root=document.createElement("div"),this.root.className="liteconsole",this.root.innerHTML="<div class='log'></div><div class='foot'><input type='text'/></div>",this.log_element=this.root.querySelector(".log"),this.input=this.root.querySelector("input"),this.input.addEventListener("keydown",this.processKeyDown.bind(this)),this._prompt=t.prompt||"]",this.onAutocomplete=null,this.onProcessCommand=null,this.history=[],this._history_offset=0}t.prototype.processKeyDown=function(t){if(!this._input_blocked){if(13==t.keyCode){var e=this.input.value.trim();this.addMessage(this._prompt+e,"me",!0),this.input.value="",this.history.push(e),10<this.history.length&&this.history.shift(),this.onProcessCommand&&this.onProcessCommand(e),this._history_offset=0}else if(38==t.keyCode||40==t.keyCode){this._history_offset+=38==t.keyCode?-1:1,0<this._history_offset?this._history_offset=0:this._history_offset<-this.history.length&&(this._history_offset=-this.history.length);var i=this.history.length+this._history_offset;if(i<0)return;i>=this.history.length?this.input.value="":this.input.value=this.history[i]}else{if(9!=t.keyCode)return;if(!this.onAutocomplete)return;this.input.value=this.onAutocomplete(this.input.value)}t.preventDefault(),t.stopPropagation()}},t.prototype.addMessage=function(t,e,i){var n=this.log_element,o=null;if(t&&t.constructor===Array)for(var r=0;r<t.length;++r)s(t[r]);else t&&t.constructor===Object?s(JSON.stringify(t,null,"")):s(t);function s(t){o=document.createElement("pre"),i?o.innerText=t:o.innerHTML=t,o.className="msg",e&&(o.className+=" "+e),n.appendChild(o),1e3<n.children.length&&n.removeChild(n.children[0])}return this.log_element.scrollTop=1e6,o.update=function(t){this.innerHTML=t},o},t.prototype.log=function(){var t=Array.prototype.slice.call(arguments).join(",");return this.addMessage(t,"msglog")},t.prototype.warn=function(){var t=Array.prototype.slice.call(arguments).join(",");return this.addMessage(t,"msgwarn")},t.prototype.error=function(){var t=Array.prototype.slice.call(arguments).join(",");return this.addMessage(t,"msgerror")},t.prototype.clear=function(){this.log_element.innerHTML=""},LiteGUI.Console=t}(),function(){function y(t,e){if(t&&t.constructor===String||e){var i=t;(t=e||{}).id=i,console.warn("LiteGUI.Area legacy parameter, use options as first parameter instead of id.")}t=t||{};var n=document.createElement("div");n.className="litearea",t.id&&(n.id=t.id),t.className&&(n.className+=" "+t.className),this.root=n,this.root.litearea=this;var o=t.width||"100%",r=t.height||"100%";o<0&&(o="calc( 100% - "+Math.abs(o)+"px)"),r<0&&(r="calc( 100% - "+Math.abs(r)+"px)"),n.style.width=o,n.style.height=r,this.options=t;var s=this;this._computed_size=[this.root.offsetWidth,this.root.offserHeight];var a=document.createElement("div");t.content_id&&(a.id=t.content_id),a.className="liteareacontent",a.style.width="100%",a.style.height="100%",this.root.appendChild(a),this.content=a,this.split_direction="none",this.sections=[],t.autoresize&&LiteGUI.bind(LiteGUI,"resized",function(){s.onResize()})}y.VERTICAL="vertical",y.HORIZONTAL="horizontal",y.splitbar_size=4,y.prototype.getSection=function(t){return t=t||0,this.sections.length>t?this.sections[t]:null},y.prototype.onResize=function(t){var e=[this.root.offsetWidth,this.root.offsetHeight];t&&this._computed_size&&e[0]==this._computed_size[0]&&e[1]==this._computed_size[1]||this.sendResizeEvent(t)},y.prototype.sendResizeEvent=function(t){if(this.sections.length)for(var e in this.sections){this.sections[e].onResize(t)}else for(var i=0;i<this.root.childNodes.length;i++){var n=this.root.childNodes[i];n.litearea?n.litearea.onResize():LiteGUI.trigger(n,"resize")}this.onresize&&this.onresize()},y.prototype.getWidth=function(){return this.root.offsetWidth},y.prototype.getHeight=function(){return this.root.offsetHeight},y.prototype.isVisible=function(){return"none"!=this.root.style.display},y.prototype.adjustHeight=function(){if(this.root.parentNode){this.root.parentNode.offsetHeight;var t=this.root.getClientRects()[0].top;this.root.style.height="calc( 100% - "+t+"px )"}else console.error("Cannot adjust height of LiteGUI.Area without parent")},y.prototype.split=function(e,t,i){if(!e||e.constructor!==String)throw"First parameter must be a string: 'vertical' or 'horizontal'";if(t=t||["50%",null],"vertical"!=e&&"horizontal"!=e)throw"First parameter must be a string: 'vertical' or 'horizontal'";if(this.sections.length)throw"cannot split twice";var n=new LiteGUI.Area({content_id:this.content.id});n.root.style.display="inline-block";var o=new LiteGUI.Area;o.root.style.display="inline-block";var r="",s=null,a=null;if(i&&(r=" - "+(y.splitbar_size+2)+"px",(s=document.createElement("div")).className="litesplitbar "+e,"vertical"==e?s.style.height=y.splitbar_size+"px":s.style.width=y.splitbar_size+"px",(this.splitbar=s).addEventListener("mousedown",function(t){var e=f.root.ownerDocument;e.addEventListener("mousemove",v),e.addEventListener("mouseup",m),g[0]=t.pageX,g[1]=t.pageY,t.stopPropagation(),t.preventDefault()})),t=t||["50%",null],"vertical"==e)if(n.root.style.width="100%",o.root.style.width="100%",null==t[0])"number"==typeof(l=t[1])&&(l=t[1]+"px"),n.root.style.height="-moz-calc( 100% - "+l+r+" )",n.root.style.height="-webkit-calc( 100% - "+l+r+" )",n.root.style.height="calc( 100% - "+l+r+" )",o.root.style.height=l,o.size=l,a=n;else if(null==t[1]){var l;"number"==typeof(l=t[0])&&(l=t[0]+"px"),n.root.style.height=l,n.size=l,o.root.style.height="-moz-calc( 100% - "+l+r+" )",o.root.style.height="-webkit-calc( 100% - "+l+r+" )",o.root.style.height="calc( 100% - "+l+r+" )",a=o}else{var c=t[0];"number"==typeof c&&(c=t[0]+"px");var d=t[1];"number"==typeof d&&(d=t[1]+"px"),n.root.style.height=c,n.size=c,o.root.style.height=d,o.size=d}else if(n.root.style.height="100%",o.root.style.height="100%",null==t[0])"number"==typeof(u=t[1])&&(u=t[1]+"px"),n.root.style.width="-moz-calc( 100% - "+u+r+" )",n.root.style.width="-webkit-calc( 100% - "+u+r+" )",n.root.style.width="calc( 100% - "+u+r+" )",o.root.style.width=u,o.size=t[1],a=n;else if(null==t[1]){var u;"number"==typeof(u=t[0])&&(u=t[0]+"px"),n.root.style.width=u,n.size=u,o.root.style.width="-moz-calc( 100% - "+u+r+" )",o.root.style.width="-webkit-calc( 100% - "+u+r+" )",o.root.style.width="calc( 100% - "+u+r+" )",a=o}else{var h=t[0];"number"==typeof h&&(h=t[0]+"px");var p=t[1];"number"==typeof p&&(p=t[1]+"px"),n.root.style.width=h,n.size=h,o.root.style.width=p,o.size=p}n.root.removeChild(n.content),n.root.appendChild(this.content),n.content=this.content,this.root.appendChild(n.root),s&&this.root.appendChild(s),this.root.appendChild(o.root),this.sections=[n,o],this.dynamic_section=a,this.direction=e;var f=this,g=[0,0];function v(t){"horizontal"==e?g[0]!=t.pageX&&f.moveSplit(g[0]-t.pageX):"vertical"==e&&g[1]!=t.pageY&&f.moveSplit(t.pageY-g[1]),g[0]=t.pageX,g[1]=t.pageY,t.stopPropagation(),t.preventDefault(),(f.options.immediateResize||f.options.inmediateResize)&&f.onResize()}function m(t){var e=f.root.ownerDocument;e.removeEventListener("mousemove",v),e.removeEventListener("mouseup",m),f.onResize()}},y.prototype.hide=function(){this.root.style.display="none"},y.prototype.show=function(){this.root.style.display="block"},y.prototype.showSection=function(t){var e=0;if(!(n=this.sections[t])||"none"==n.root.style.display){for(var i in-1!=(e="horizontal"==this.direction?n.root.style.width:n.root.style.height).indexOf("calc")&&(e="50%"),this.sections){var n=this.sections[i];i==t?n.root.style.display="inline-block":"horizontal"==this.direction?n.root.style.width="calc( 100% - "+e+" - 5px)":n.root.style.height="calc( 100% - "+e+" - 5px)"}this.splitbar&&(this.splitbar.style.display="inline-block"),this.sendResizeEvent()}},y.prototype.hideSection=function(t){for(var e in this.sections){var i=this.sections[e];e==t?i.root.style.display="none":"horizontal"==this.direction?i.root.style.width="100%":i.root.style.height="100%"}this.splitbar&&(this.splitbar.style.display="none"),this.sendResizeEvent()},y.prototype.moveSplit=function(t){if(this.sections){var e=this.sections[0],i=this.sections[1],n=" - "+y.splitbar_size+"px",o=this.options.minSplitSize||10;if("horizontal"==this.direction)if(this.dynamic_section==e)(r=i.root.offsetWidth+t)<o&&(r=o),e.root.style.width="-moz-calc( 100% - "+r+"px "+n+" )",e.root.style.width="-webkit-calc( 100% - "+r+"px "+n+" )",e.root.style.width="calc( 100% - "+r+"px "+n+" )",i.root.style.width=r+"px";else(r=e.root.offsetWidth-t)<o&&(r=o),i.root.style.width="-moz-calc( 100% - "+r+"px "+n+" )",i.root.style.width="-webkit-calc( 100% - "+r+"px "+n+" )",i.root.style.width="calc( 100% - "+r+"px "+n+" )",e.root.style.width=r+"px";else if("vertical"==this.direction){var r;if(this.dynamic_section==e)(r=i.root.offsetHeight-t)<o&&(r=o),e.root.style.height="-moz-calc( 100% - "+r+"px "+n+" )",e.root.style.height="-webkit-calc( 100% - "+r+"px "+n+" )",e.root.style.height="calc( 100% - "+r+"px "+n+" )",i.root.style.height=r+"px";else(r=e.root.offsetHeight+t)<o&&(r=o),i.root.style.height="-moz-calc( 100% - "+r+"px "+n+" )",i.root.style.height="-webkit-calc( 100% - "+r+"px "+n+" )",i.root.style.height="calc( 100% - "+r+"px "+n+" )",e.root.style.height=r+"px"}LiteGUI.trigger(this.root,"split_moved");for(var s=this.root.querySelectorAll(".litearea"),a=0;a<s.length;++a)LiteGUI.trigger(s[a],"split_moved")}},y.prototype.addEventListener=function(t,e,i,n){return this.root.addEventListener(t,e,i,n)},y.prototype.setAreaSize=function(t,e){var i=this.sections[1],n=" - "+y.splitbar_size+"px";i.root.style.width="-moz-calc( 100% - "+e+n+" )",i.root.style.width="-webkit-calc( 100% - "+e+n+" )",i.root.style.width="calc( 100% - "+e+n+" )"},y.prototype.merge=function(t){if(0==this.sections.length)throw"not splitted";var e=this.sections[t||0];this.root.appendChild(e.content),this.content=e.content,this.root.removeChild(this.sections[0].root),this.root.removeChild(this.sections[1].root),this.sections=[],this._computed_size=null,this.onResize()},y.prototype.add=function(t){if("string"==typeof t){var e=document.createElement("div");e.innerHTML=t,t=e}this.content.appendChild(t.root||t)},y.prototype.query=function(t){return this.root.querySelector(t)},LiteGUI.Area=y,LiteGUI.Split=function(t,e,i){if(e=e||{},t&&t.constructor===String){var n=t;t=e,(e=i||{}).id=n,console.warn("LiteGUI.Split legacy parameter, use sections as first parameter instead of id.")}var o=document.createElement("div");for(var r in this.root=o,e.id&&(o.id=n),o.className="litesplit "+(e.vertical?"vsplit":"hsplit"),this.sections=[],t){var s=document.createElement("div");s.className="split-section split"+r,"number"==typeof t[r]?e.vertical?s.style.height=t[r].toFixed(1)+"%":s.style.width=t[r].toFixed(1)+"%":"string"==typeof t[r]?e.vertical?s.style.height=t[r]:s.style.width=t[r]:(t[r].id&&(s.id=t[r].id),e.vertical?s.style.height="Number"==typeof t[r].height?t[r].height.toFixed(1)+"%":t[r].height:s.style.width="Number"==typeof t[r].width?t[r].width.toFixed(1)+"%":t[r].width),s.add=function(t){this.appendChild(t.root||t)},this.sections.push(s),o.appendChild(s)}e.parent&&(e.parent.root?e.parent.root.appendChild(o):e.parent.appendChild(o)),this.getSection=function(t){return this.sections[t]}}}(),function(){function t(t,e){e=e||{},this.menu=[],this.panels=[],this.root=document.createElement("div"),this.root.id=t,this.root.className="litemenubar",this.content=document.createElement("ul"),this.root.appendChild(this.content),this.is_open=!1,this.auto_open=e.auto_open||!1,this.sort_entries=e.sort_entries||!1}t.closing_time=500,t.prototype.clear=function(){this.content.innerHTML="",this.menu=[],this.panels=[]},t.prototype.attachToPanel=function(t){t.content.insertBefore(this.root,t.content.firstChild)},t.prototype.add=function(t,e){"function"==typeof(e=e||{})&&(e={callback:e});for(var i=this.menu.length,n=t.split("/"),o=0,r=0,s=this.menu,a=null;s;){if(5<o)throw"Error: Menubar too deep";if(s.length!=r){if(s[r]&&n[o]==s[r].name){if(o<n.length-1){a=s[r],s=s[r].children,r=0,o++;continue}console.warn("Warning: Adding menu that already exists: "+t);break}r++}else{var l={parent:a,children:[]};if(a=l,o==n.length-1&&(l.data=e),l.disable=function(){this.data&&(this.data.disabled=!0)},l.enable=function(){this.data&&delete this.data.disabled},l.name=n[o],s.push(l),++o==n.length)break;l.children=[],s=l.children,r=0}}i!=this.menu.length&&this.updateMenu()},t.prototype.remove=function(t){var e=this.findMenu(t);if(e){if(!e.parent||!e.parent.children)return console.warn("menu without parent?");var i=e.parent.children.indexOf(e);-1!=i&&e.parent.children.splice(i,1)}},t.prototype.separator=function(t,e){var i=this.findMenu(t);i&&i.children.push({separator:!0,order:e||10})},t.prototype.findMenu=function(t){for(var e=t.split("/"),i=0,n=0,o=this.menu;o;){if(i==e.length)return o;if(o.length<=n)return null;if("*"==e[i])return o[n].children;if(e[i]!=o[n].name)n++;else{if(i==e.length-1)return o[n];o=o[n].children,n=0,i++}}return null},t.prototype.updateMenu=function(){var i=this;for(var t in this.content.innerHTML="",this.menu){var e=document.createElement("li");e.innerHTML="<span class='icon'></span><span class='name'>"+this.menu[t].name+"</span>",this.content.appendChild(e),e.data=this.menu[t],(this.menu[t].element=e).addEventListener("click",function(t){var e=this.data;e.data&&e.data.callback&&"function"==typeof e.data.callback&&e.data.callback(e.data),i.is_open?(i.is_open=!1,i.hidePanels()):(i.is_open=!0,i.showMenu(e,t,this))}),e.addEventListener("mouseover",function(t){i.hidePanels(),(i.is_open||i.auto_open)&&i.showMenu(this.data,t,this)})}},t.prototype.hidePanels=function(){if(this.panels.length){for(var t in this.panels)LiteGUI.remove(this.panels[t]);this.panels=[]}},t.prototype.showMenu=function(t,e,i,n){if(n||this.hidePanels(),t.children&&t.children.length){var o=this;o.closing_by_leave&&clearInterval(o.closing_by_leave);var r=document.createElement("div");r.className="litemenubar-panel";var s=[];for(var a in t.children)s.push(t.children[a]);for(var a in this.sort_entries&&s.sort(function(t,e){var i=10,n=10;return t&&t.data&&null!=t.data.order&&(i=t.data.order),t&&t.separator&&null!=t.order&&(i=t.order),e&&e.data&&null!=e.data.order&&(n=e.data.order),e&&e.separator&&null!=e.order&&(n=e.order),i-n}),s){var l=document.createElement("p"),c=s[a];l.className="litemenu-entry "+(l.children?" submenu":"");var d=c.children&&c.children.length;if(d&&l.classList.add("has_submenu"),c&&c.name?l.innerHTML="<span class='icon'></span><span class='name'>"+c.name+(d?"<span class='more'>+</span>":"")+"</span>":l.classList.add("separator"),l.data=c,l.data.data){var u=l.data.data;("checkbox"==u.type&&u.instance&&u.property&&1==u.instance[u.property]||1==u.checkbox||u.instance&&u.property&&u.hasOwnProperty("value")&&u.instance[u.property]==u.value||"function"==typeof u.isChecked&&u.isChecked.call(u.instance,u))&&(l.className+=" checked"),u.disabled&&(l.className+=" disabled")}l.addEventListener("click",function(){var t=this.data;if(t.data){if(t.data.disabled)return;t.data.instance&&t.data.property&&("checkbox"==t.data.type?(t.data.instance[t.data.property]=!t.data.instance[t.data.property],t.data.instance[t.data.property]?this.classList.add("checked"):this.classList.remove("checked")):t.data.hasOwnProperty("value")&&(t.data.instance[t.data.property]=t.data.value)),null!=t.data.checkbox&&(t.data.checkbox=!t.data.checkbox,t.data.checkbox?this.classList.add("checked"):this.classList.remove("checked")),t.data.callback&&"function"==typeof t.data.callback&&t.data.callback(t.data)}t.children&&t.children.length?o.showMenu(t,e,this,!0):(o.is_open=!1,o.hidePanels())}),l.addEventListener("mouseenter",function(t){}),r.appendChild(l)}r.addEventListener("mouseleave",function(t){o.closing_by_leave&&clearInterval(o.closing_by_leave),o.closing_by_leave=setTimeout(function(){o.is_open=!1,o.hidePanels()},LiteGUI.Menubar.closing_time)}),r.addEventListener("mouseenter",function(t){o.closing_by_leave&&clearInterval(o.closing_by_leave),o.closing_by_leave=null});var h=i.getBoundingClientRect();r.style.left=h.left+(n?200:0)+"px",r.style.top=h.top+h.height+(n?-20:10)+"px",this.panels.push(r),document.body.appendChild(r)}},LiteGUI.Menubar=t}(),function(){function d(t,e){if(e||t&&t.constructor===String){var i=t;(t=e||{}).id=i,console.warn("LiteGUI.Tabs legacy parameter, use options as first parameter instead of id.")}t=t||{},this.options=t;var n=this.mode=t.mode||"horizontal",o=document.createElement("DIV");t.id&&(o.id=t.id),o.data=this,o.className="litetabs "+n,this.root=o,(this.root.tabs=this).current_tab=null,"horizontal"==n?t.size&&("full"==t.size?this.root.style.height="100%":this.root.style.height=t.size):"vertical"==n&&t.size&&("full"==t.size?this.root.style.width="100%":this.root.style.width=t.size),t.width&&(this.root.style.width=t.width.constructor===Number?t.width.toFixed(0)+"px":t.width),t.height&&(this.root.style.height=t.height.constructor===Number?t.height.toFixed(0)+"px":t.height);var r=document.createElement("UL");function s(t){t.deltaY&&(r.scrollLeft+=t.deltaY)}r.className="wtabcontainer","vertical"==n?r.style.width=LiteGUI.Tabs.tabs_width+"px":r.style.height=LiteGUI.Tabs.tabs_height+"px",r.addEventListener("wheel",s),r.addEventListener("mousewheel",s),this.list=r,this.root.appendChild(this.list),this.tabs_root=r,this.tabs={},this.tabs_by_index=[],this.selected=null,this.onchange=t.callback,t.parent&&this.appendTo(t.parent)}d.tabs_width=64,d.tabs_height=26,d.prototype.show=function(){this.root.style.display="block"},d.prototype.hide=function(){this.root.style.display="none"},d.prototype.getCurrentTab=function(){return this.current_tab?this.tabs[this.current_tab[0]]:null},d.prototype.getCurrentTabId=function(){return this.current_tab[0]},d.prototype.getPreviousTab=function(){return this.previous_tab?this.tabs[this.previous_tab[0]]:null},d.prototype.appendTo=function(t,e){e?t.prepend(this.root):t.appendChild(this.root)},d.prototype.getTab=function(t){return this.tabs[t]},d.prototype.getTabByIndex=function(t){return this.tabs_by_index[t]},d.prototype.getNumOfTabs=function(){var t=0;for(var e in this.tabs)t++;return t},d.prototype.getTabContent=function(t){var e=this.tabs[t];if(e)return e.content},d.prototype.getTabIndex=function(t){var e=this.tabs[t];if(!e)return-1;for(var i=0;i<this.list.childNodes.length;i++)if(this.list.childNodes[i]==e.tab)return i;return-1},d.prototype.addTab=function(e,i,t){"function"==typeof(i=i||{})&&(i={callback:i});var n=this;null==e&&(e="rand_"+(1e6*Math.random()|0));var o=document.createElement("LI"),r=e.replace(/ /gi,"_");if(o.className="wtab wtab-"+r+" ",o.dataset.id=e,o.innerHTML="<span class='tabtitle'>"+(i.title||e)+"</span>",i.button&&(o.className+="button "),i.tab_className&&(o.className+=i.tab_className),i.bigicon&&(o.innerHTML="<img class='tabbigicon' src='"+i.bigicon+"'/>"+o.innerHTML),i.closable&&(o.innerHTML+="<span class='tabclose'>"+LiteGUI.special_codes.close+"</span>",o.querySelector("span.tabclose").addEventListener("click",function(t){n.removeTab(e),t.preventDefault(),t.stopPropagation()},!0)),void 0!==i.index){var s=this.list.childNodes[i.index];s?this.list.insertBefore(o,s):this.list.appendChild(o)}else this.plus_tab?this.list.insertBefore(o,this.plus_tab):this.list.appendChild(o);i.tab_width&&(o.style.width=i.tab_width.constructor===Number?i.tab_width.toFixed(0)+"px":i.tab_width,o.style.minWidth="0"),this.options.autoswitch&&(o.classList.add("autoswitch"),o.addEventListener("dragenter",function(t){n._timeout_mouseover&&clearTimeout(n._timeout_mouseover),n._timeout_mouseover=setTimeout(function(){LiteGUI.trigger(this,"click"),n._timeout_mouseover=null}.bind(this),500)}),o.addEventListener("dragleave",function(t){n._timeout_mouseover&&(clearTimeout(n._timeout_mouseover),n._timeout_mouseover=null)}));var a=document.createElement("div");i.id&&(a.id=i.id),a.className="wtabcontent wtabcontent-"+r+" "+(i.className||""),a.dataset.id=e,a.style.display="none","horizontal"==this.mode?i.size&&(a.style.overflow="auto","full"==i.size?(a.style.width="100%",a.style.height="calc( 100% - "+LiteGUI.Tabs.tabs_height+"px )",a.style.height="-moz-calc( 100% - "+LiteGUI.Tabs.tabs_height+"px )",a.style.height="-webkit-calc( 100% - "+LiteGUI.Tabs.tabs_height+"px )"):a.style.height=i.size):"vertical"==this.mode&&i.size&&(a.style.overflow="auto","full"==i.size?(a.style.height="100%",a.style.width="calc( 100% - "+LiteGUI.Tabs.tabs_width+"px )",a.style.width="-moz-calc( 100% - "+LiteGUI.Tabs.tabs_width+"px )",a.style.width="-webkit-calc( 100% - "+LiteGUI.Tabs.tabs_width+"px )"):a.style.width=i.size),void 0!==i.width&&(a.style.width="string"==typeof i.width?i.width:i.width+"px"),void 0!==i.height&&(a.style.height="string"==typeof i.height?i.height:i.height+"px"),i.content&&("string"==typeof i.content?a.innerHTML=i.content:a.appendChild(i.content)),this.root.appendChild(a),i.button?o.addEventListener("click",function(t){var e=this.dataset.id;i.callback&&i.callback(e,t)}):o.addEventListener("click",d.prototype.onTabClicked),o.options=i,o.tabs=this;var l=o.querySelector("span.tabtitle"),c={id:e,tab:o,content:a,title:l,add:function(t){this.content.appendChild(t.root||t)},setTitle:function(t){this.title.innerHTML=t},click:function(){LiteGUI.trigger(this.tab,"click")},destroy:function(){n.removeTab(this.id)}};return i.onclose&&(c.onclose=i.onclose),this.tabs[e]=c,this.recomputeTabsByIndex(),o.addEventListener("contextmenu",function(t){return 2!=t.button||(t.preventDefault(),i.callback_context&&i.callback_context.call(c)),!1}.bind(this)),1!=i.selected&&null!=this.selected||this.selectTab(e,i.skip_callbacks),c},d.prototype.addPlusTab=function(t){this.plus_tab&&console.warn("There is already a plus tab created in this tab widget"),this.plus_tab=this.addTab("plus_tab",{title:"+",tab_width:20,button:!0,callback:t,skip_callbacks:!0})},d.prototype.addButtonTab=function(t,e,i){return this.addTab(t,{title:e,tab_width:20,button:!0,callback:i,skip_callbacks:!0})},d.prototype.onTabClicked=function(t){if(!this.classList.contains("selected")&&this.parentNode){var e=this.options,i=this.parentNode.parentNode.tabs;if(!i)throw"tabs not found";var n=i;if(!e.callback_canopen||0!=e.callback_canopen()){n.current_tab&&n.current_tab[0]!=o&&n.current_tab[2]&&n.current_tab[2].callback_leave&&n.current_tab[2].callback_leave(n.current_tab[0],n.current_tab[1],n.current_tab[2]);var o=this.dataset.id,r=null;for(var s in n.tabs){var a=n.tabs[s];s==o?(a.selected=!0,a.content.style.display="",r=a.content):(delete a.selected,a.content.style.display="none")}var l=n.list.querySelectorAll("li.wtab");for(s=0;s<l.length;++s)l[s].classList.remove("selected");this.classList.add("selected"),n.previous_tab=n.current_tab,n.current_tab=[o,r,e],t&&(e.callback&&e.callback(o,r,t),LiteGUI.trigger(n,"wchange",[o,r]),n.onchange&&n.onchange(o,r)),n.selected=o}}},d.prototype.selectTab=function(t,e){if(t){t.constructor!=String&&(t=t.id);for(var i=this.list.querySelectorAll("li.wtab"),n=0;n<i.length;n++)if(t==i[n].dataset.id){this.onTabClicked.call(i[n],!e);break}}},d.prototype.setTabVisibility=function(t,e){var i=this.tabs[t];i&&(i.tab.style.display=e?"none":null,i.content.style.display=e?"none":null)},d.prototype.recomputeTabsByIndex=function(){for(var t in this.tabs_by_index=[],this.tabs){for(var e=this.tabs[t],i=0,n=e.tab;null!=(n=n.previousSibling);)i++;this.tabs_by_index[i]=e}},d.prototype.removeTab=function(t){var e=this.tabs[t];e?(e.onclose&&e.onclose(e),e.tab.parentNode&&e.tab.parentNode.removeChild(e.tab),e.content.parentNode&&e.content.parentNode.removeChild(e.content),delete this.tabs[t],this.recomputeTabsByIndex()):console.warn("tab not found: "+t)},d.prototype.removeAllTabs=function(t){var e=[];for(var i in this.tabs)e.push(this.tabs[i]);for(var i in e){var n=e[i];n==this.plus_tab&&t||(n.tab.parentNode&&n.tab.parentNode.removeChild(n.tab),n.content.parentNode&&n.content.parentNode.removeChild(n.content),delete this.tabs[n.id])}this.recomputeTabsByIndex()},d.prototype.clear=function(){this.removeAllTabs()},d.prototype.hideTab=function(t){this.setTabVisibility(t,!1)},d.prototype.showTab=function(t){this.setTabVisibility(t,!0)},d.prototype.transferTab=function(t,e,i){var n=this.tabs[t];if(n){e.tabs[t]=n,void 0!==i?e.list.insertBefore(n.tab,e.list.childNodes[i]):e.list.appendChild(n.tab),e.root.appendChild(n.content),delete this.tabs[t];var o=null;for(var r in this.tabs){o=r;break}o&&this.selectTab(o),n.tab.classList.remove("selected"),e.selectTab(t)}},d.prototype.detachTab=function(t,e,i){if(this.tabs[t]){var n=this.getTabIndex(t),o=window.open("","","width=800, height=600, location=no, status=no, menubar=no, titlebar=no, fullscreen=yes");o.document.write("<head><title>"+t+"</title>");for(var r=document.querySelectorAll("link[rel='stylesheet'],style"),s=0;s<r.length;s++)o.document.write(r[s].outerHTML);o.document.write("</head><body></body>"),o.document.close();var a=this,l=new LiteGUI.Tabs(null,this.options);return o.tabs=l,o.onbeforeunload=function(){l.transferTab(t,a,n),i&&i()},l.list.style.height="20px",o.document.body.appendChild(l.root),a.transferTab(t,l),l.tabs[t].tab.classList.add("selected"),this.recomputeTabsByIndex(),e&&e(),o}},LiteGUI.Tabs=d}(),function(){function t(t,o){null==t?t=0:t.constructor===String?t=parseFloat(t):t.constructor!==Number&&(t=0),this.value=t;var r=null!=o.precision?o.precision:3;this.options=o||{};var i=document.createElement("div");i.className="dragger "+(o.extraclass?o.extraclass:""),this.root=i;var e=document.createElement("span");e.className="inputfield "+(o.extraclass?o.extraclass:"")+(o.full?" full":""),o.disabled&&(e.className+=" disabled"),i.appendChild(e);var n=o.dragger_class||"full",s=document.createElement("input");s.className="text number "+(n||""),s.value=t.toFixed(r)+(o.units?o.units:""),s.tabIndex=o.tab_index,this.input=s,i.input=s,o.disabled&&(s.disabled=!0),o.tab_index&&(s.tabIndex=o.tab_index),e.appendChild(s),s.addEventListener("keydown",function(t){if(38==t.keyCode)h(1,t);else{if(40!=t.keyCode)return;h(-1,t)}return t.stopPropagation(),t.preventDefault(),!0});var a=document.createElement("div");a.className="drag_widget",o.disabled&&(a.className+=" disabled"),e.appendChild(a),(i.dragger=a).addEventListener("mousedown",function(t){(l=s.ownerDocument).removeEventListener("mousemove",c),l.removeEventListener("mouseup",u),o.disabled||(i.requestPointerLock&&i.requestPointerLock(),l.addEventListener("mousemove",c),l.addEventListener("mouseup",u),a.data=[t.screenX,t.screenY],LiteGUI.trigger(i,"start_dragging"));t.stopPropagation(),t.preventDefault()}),s.addEventListener("wheel",d,!1),s.addEventListener("mousewheel",d,!1);var l=null;function c(t){var e=[t.screenX-a.data[0],a.data[1]-t.screenY];return void 0!==t.movementX&&(e=[t.movementX,-t.movementY]),a.data=[t.screenX,t.screenY],h(e[o.horizontal?0:1],t),t.stopPropagation(),t.preventDefault(),!1}function d(t){document.activeElement===this&&(h(0<(void 0!==t.wheelDelta?t.wheelDelta:t.deltaY?-t.deltaY/3:0)?1:-1,t),t.stopPropagation(),t.preventDefault())}function u(t){LiteGUI.trigger(i,"stop_dragging");var e=l||document;return l=null,e.removeEventListener("mousemove",c),e.removeEventListener("mouseup",u),e.exitPointerLock&&e.exitPointerLock(),LiteGUI.trigger(a,"blur"),t.stopPropagation(),t.preventDefault(),!1}function h(t,e){o.linear||(t=0<t?Math.pow(t,1.2):-1*Math.pow(Math.abs(t),1.2));var i=o.step?o.step:1;e&&e.shiftKey?i*=10:e&&e.ctrlKey&&(i*=.1);var n=parseFloat(s.value)+t*i;null!=o.max&&n>o.max&&(n=o.max),null!=o.min&&n<o.min&&(n=o.min),s.value=n.toFixed(r),o.units&&(s.value+=o.units),LiteGUI.trigger(s,"change")}}t.prototype.setRange=function(t,e){this.options.min=t,this.options.max=e},t.prototype.setValue=function(t,e){t=parseFloat(t),this.value=t,this.options.precision&&(t=t.toFixed(this.options.precision)),this.options.units&&(t+=this.options.units),this.input.value=t,e||LiteGUI.trigger(this.input,"change")},t.prototype.getValue=function(){return this.value},LiteGUI.Dragger=t}(),function(){function u(t,e,i){if(i||t&&t.constructor===String){var n=t;t=e,(e=i||{}).id=n,console.warn("LiteGUI.Tree legacy parameter, use data as first parameter instead of id.")}e=e||{};var o=document.createElement("div");this.root=o,e.id&&(o.id=e.id),o.className="litetree",this.tree=t;var r=this;e=e||{allow_rename:!1,allow_drag:!0,allow_multiselection:!1},this.options=e,this.indent_offset=e.indent_offset||0,e.height&&(this.root.style.height="string"==typeof e.height?e.height:Math.round(e.height)+"px"),this.collapsed_depth=3,null!=e.collapsed_depth&&(this.collapsed_depth=e.collapsed_depth),o.addEventListener("click",function(t){t.srcElement==r.root&&r.onBackgroundClicked&&r.onBackgroundClicked(t,r)}),o.addEventListener("contextmenu",function(t){return 2!=t.button||(r.onContextMenu&&r.onContextMenu(t),t.preventDefault()),!1});var s=this.createAndInsert(t,e,null);if(!s)throw"Error in LiteGUI.Tree, createAndInsert returned null";s.className+=" root_item",this.root_item=s}u.INDENT=20,u.prototype.updateTree=function(t){this.root.innerHTML="";var e=this.createAndInsert(t,this.options,null);e?(e.className+=" root_item",this.root_item=e):this.root_item=null},u.prototype.insertItem=function(t,e,i,n){if(!e){var o=this.root.childNodes[0];o&&(e=o.dataset.item_id)}var r=this.createAndInsert(t,n,e,i);return e&&this._updateListBox(this._findElement(e)),r},u.prototype.createAndInsert=function(t,e,i,n){var o=-1;i?o=this._findElementIndex(i):void 0===i&&(o=0);var r=null,s=0;-1!=o&&(r=this.root.childNodes[o],s=parseInt(r.dataset.level)+1);var a=this.createTreeItem(t,e,s);if(a){if(a.parent_id=i,this.getItem(a.dataset.item_id)&&console.warn("There another item with the same ID in this tree"),-1==o?this.root.appendChild(a):this._insertInside(a,o,n),r&&!this._isNodeChildrenVisible(i)&&a.classList.add("hidden"),t.children)for(var l=0;l<t.children.length;++l)this.createAndInsert(t.children[l],e,t.id);return this._updateListBox(a,e,s),e&&e.selected&&this.markAsSelected(a,!0),a}},u.prototype._insertInside=function(t,e,i,n){var o=this.root.childNodes[e];if(!o)throw"No parent node found, index: "+e+", nodes: "+this.root.childNodes.length;var r=parseInt(o.dataset.level),s=void 0!==n?n:r+1,a=t.querySelector(".indentblock");a&&(a.style.paddingLeft=(s+this.indent_offset)*u.INDENT+"px"),t.dataset.level=s;for(var l=e+1;l<this.root.childNodes.length;++l){var c=this.root.childNodes[l];if(c.classList&&c.classList.contains("ltreeitem")){var d=parseInt(c.dataset.level);if(d==s&&i)i--;else if(d<s||0===i&&d===s)return void this.root.insertBefore(t,c)}}this.root.appendChild(t)},u.prototype._isNodeChildrenVisible=function(t){var e=this.getItem(t);if(!e)return!1;if(e.classList.contains("hidden"))return!1;var i=e.querySelector(".listbox");return!i||"closed"!=i.getValue()},u.prototype._findElement=function(t){if(!t||t.constructor!==String)throw"findElement param must be string with item id";for(var e=0;e<this.root.childNodes.length;++e){var i=this.root.childNodes[e];if(i.classList&&i.classList.contains("ltreeitem")&&i.classList.contains("ltreeitem-"+t))return i}return null},u.prototype._findElementIndex=function(t){for(var e=0;e<this.root.childNodes.length;++e){var i=this.root.childNodes[e];if(i.classList&&i.classList.contains("ltreeitem"))if("string"==typeof t){if(i.dataset.item_id===t)return e}else if(i===t)return e}return-1},u.prototype._findElementLastChildIndex=function(t){if(-1==t)return-1;for(var e=parseInt(this.root.childNodes[t].dataset.level),i=t+1;i<this.root.childNodes.length;++i){var n=this.root.childNodes[i];if(n.classList&&n.classList.contains("ltreeitem"))if(parseInt(n.dataset.level)==e)return i}return-1},u.prototype._findChildElements=function(t,e){var i=this._findElementIndex(t);if(-1!=i){for(var n=this.root.childNodes[i],o=parseInt(n.dataset.level),r=[],s=i+1;s<this.root.childNodes.length;++s){var a=this.root.childNodes[s];if(a.classList&&a.classList.contains("ltreeitem")){var l=parseInt(a.dataset.level);if(!(e&&o+1<l)){if(l<=o)return r;r.push(a)}}}return r}},u.prototype.createTreeItem=function(d,t,e){if(null!=d){t=t||this.options;var i=document.createElement("li");i.className="ltreeitem";var u=this;if(d.id){var n=d.id.replace(/\s/g,"_");i.className+=" ltreeitem-"+n,i.dataset.item_id=d.id}if(d.dataset)for(var o in d.dataset)i.dataset[o]=d.dataset[o];(d.DOM=i).data=d,void 0!==e&&(i.dataset.level=e,i.classList.add("ltree-level-"+e));var r=document.createElement("div");r.className="ltreeitemtitle",d.className&&(r.className+=" "+d.className),r.innerHTML="<span class='precontent'></span><span class='indentblock'></span><span class='collapsebox'></span><span class='incontent'></span><span class='postcontent'></span>";var s=d.content||d.id||"";if(r.querySelector(".incontent").innerHTML=s,d.precontent&&(r.querySelector(".precontent").innerHTML=d.precontent),d.dataset)for(var o in d.dataset)i.dataset[o]=d.dataset[o];i.appendChild(r),i.title_element=r,!1===d.visible&&(i.style.display="none");var a=i;a.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation();var e=this;if(e.title_element._editing)return;if(t.ctrlKey&&u.options.allow_multiselection){if(u.isNodeSelected(e))return e.classList.remove("selected"),LiteGUI.trigger(u,"item_remove_from_selection",{item:e,data:e.data}),void LiteGUI.trigger(u.root,"item_remove_from_selection",{item:e,data:e.data});u.markAsSelected(e,!0),LiteGUI.trigger(u,"item_add_to_selection",{item:e,data:e.data}),LiteGUI.trigger(u.root,"item_add_to_selection",{item:e,data:e.data});var i=!1;d.callback&&(i=d.callback.call(u,e)),!i&&u.onItemAddToSelection&&u.onItemAddToSelection(e.data,e)}if(t.shiftKey&&u.options.allow_multiselection){var n=u.getSelectedItem();if(!n)return;if(n===e)return;for(var o=Array.prototype.slice.call(n.parentNode.children),r=o.indexOf(n),s=o.indexOf(e),a=r<s?o.slice(r,s):o.slice(s,r),l=0;l<a.length;++l){var c=a[l];u.markAsSelected(c,!0),LiteGUI.trigger(u,"item_add_to_selection",{item:c,data:c.data}),LiteGUI.trigger(u.root,"item_add_to_selection",{item:c,data:c.data})}}else{u.markAsSelected(e),u._skip_scroll=!0,LiteGUI.trigger(u,"item_selected",{item:e,data:e.data}),LiteGUI.trigger(u.root,"item_selected",{item:e,data:e.data});i=!1;d.callback&&(i=d.callback.call(u,e)),!i&&u.onItemSelected&&u.onItemSelected(e.data,e),u._skip_scroll=!1}}),a.addEventListener("dblclick",function(t){var i=this,e=i.title_element.querySelector(".incontent");if(LiteGUI.trigger(u,"item_dblclicked",i),LiteGUI.trigger(u.root,"item_dblclicked",i),!e._editing&&u.options.allow_rename){e._editing=!0,e._old_name=e.innerHTML;var n=e;e.innerHTML="<input type='text' value='"+e.innerHTML+"' />";var o=e.querySelector("input");o.addEventListener("blur",function(t){var e=t.target.value;setTimeout(function(){n.innerHTML=e},1),delete n._editing,LiteGUI.trigger(u.root,"item_renamed",{old_name:n._old_name,new_name:e,item:i,data:i.data}),delete n._old_name}),o.addEventListener("keydown",function(t){13==t.keyCode&&this.blur()}),o.focus(),t.preventDefault()}t.preventDefault(),t.stopPropagation()}),a.addEventListener("contextmenu",function(t){if(t.preventDefault(),t.stopPropagation(),2==t.button)return!!u.onItemContextMenu&&u.onItemContextMenu(t,{item:this,data:this.data})});var l=r;this.options.allow_drag&&(l.draggable=!0,l.addEventListener("dragstart",function(t){if(t.dataTransfer.setData("item_id",this.parentNode.dataset.item_id),d.onDragData){var e=d.onDragData();if(e)for(var i in e)t.dataTransfer.setData(i,e[i])}}));var c=0;return l.addEventListener("dragenter",function(t){if(t.preventDefault(),d.skipdrag)return!1;0==c&&r.classList.add("dragover"),c++}),l.addEventListener("dragleave",function(t){t.preventDefault(),0==--c&&r.classList.remove("dragover")}),l.addEventListener("dragover",function(t){t.preventDefault()}),l.addEventListener("drop",function(t){if(r.classList.remove("dragover"),t.preventDefault(),d.skipdrag)return!1;var e=t.dataTransfer.getData("item_id");if(!e)return LiteGUI.trigger(u.root,"drop_on_item",{item:this,event:t}),void(u.onDropItem&&u.onDropItem(t,this.parentNode.data));var i=this.parentNode.dataset.item_id;(!u.onMoveItem||u.onMoveItem&&0!=u.onMoveItem(u.getItem(e),u.getItem(i)))&&u.moveItem(e,i)&&LiteGUI.trigger(u.root,"item_moved",{item:u.getItem(e),parent_item:u.getItem(i)}),u.onDropItem&&u.onDropItem(t,this.parentNode.data)}),i}console.error("Tree item cannot be null")},u.prototype.filterByName=function(t){for(var e=0;e<this.root.childNodes.length;++e){var i=this.root.childNodes[e];if(i.classList&&i.classList.contains("ltreeitem")){var n=i.querySelector(".incontent");if(n){var o=n.innerHTML.toLowerCase();if(t&&-1==o.indexOf(t.toLowerCase()))i.classList.add("filtered");else{i.data&&!1!==i.data.visible&&i.classList.remove("filtered");var r=i.querySelector(".indentblock");r&&(r.style.paddingLeft=t?0:paddingLeft=(parseInt(i.dataset.level)+this.indent_offset)*u.INDENT+"px")}}}}},u.prototype.filterByRule=function(t,e){if(!t)throw"filterByRule requires a callback";for(var i=0;i<this.root.childNodes.length;++i){var n=this.root.childNodes[i];if(n.classList&&n.classList.contains("ltreeitem")){var o=n.querySelector(".incontent");if(o)if(t(n.data,o,e)){n.data&&!1!==n.data.visible&&n.classList.remove("filtered");var r=n.querySelector(".indentblock");r&&(name?r.style.paddingLeft=0:r.style.paddingLeft=paddingLeft=(parseInt(n.dataset.level)+this.indent_offset)*LiteGUI.Tree.INDENT+"px")}else n.classList.add("filtered")}}},u.prototype.getItem=function(t){if(!t)return null;if(t.classList)return t;for(var e=0;e<this.root.childNodes.length;++e){var i=this.root.childNodes[e];if(i.classList&&i.classList.contains("ltreeitem")&&i.dataset.item_id===t)return i}return null},u.prototype.expandItem=function(t,e){var i=this.getItem(t);if(i&&i.listbox&&(i.listbox.setValue(!0),e)){var n=this.getParent(i);n&&this.expandItem(n,e)}},u.prototype.collapseItem=function(t){var e=this.getItem(t);e&&e.listbox&&listbox.setValue(!1)},u.prototype.isInsideArea=function(t){var e=t.constructor===String?this.getItem(t):t;if(!e)return!1;var i=this.root.getClientRects();if(!i.length)return!1;var n=i[0].height,o=e.offsetTop;return this.root.scrollTop<o&&o<this.root.scrollTop+n},u.prototype.scrollToItem=function(t){var e=t.constructor===String?this.getItem(t):t;if(e){var i=this.root.parentNode;if(i){var n=i.getBoundingClientRect();if(n){var o=n.height,r=(parseInt(e.dataset.level)+this.indent_offset)*u.INDENT+50;i.scrollTop=e.offsetTop-.5*o|0,.75*n.width<r?i.scrollLeft=r:i.scrollLeft=0}}}},u.prototype.setSelectedItem=function(t,e,i){if(t){var n=this.getItem(t);if(!n)return null;if(!n.classList.contains("selected"))return this.markAsSelected(n),e&&!this._skip_scroll&&this.scrollToItem(n),this.expandItem(n,!0),i&&LiteGUI.trigger(n,"click"),n}else this.unmarkAllAsSelected()},u.prototype.addItemToSelection=function(t){if(t){var e=this.getItem(t);return e?(this.markAsSelected(e,!0),e):null}},u.prototype.removeItemFromSelection=function(t){if(t){var e=this.getItem(t);if(!e)return null;e.classList.remove("selected")}},u.prototype.getSelectedItem=function(){return this.root.querySelector(".ltreeitem.selected")},u.prototype.getSelectedItems=function(){return this.root.querySelectorAll(".ltreeitem.selected")},u.prototype.isItemSelected=function(t){var e=this.getItem(t);return!!e&&this.isNodeSelected(e)},u.prototype.getChildren=function(t,e){return t&&t.constructor!==String&&t.dataset&&(t=t.dataset.item_id),this._findChildElements(t,e)},u.prototype.getParent=function(t){var e=this.getItem(t);return e?this.getItem(e.parent_id):null},u.prototype.getAncestors=function(t,e){e=e||[];var i=this.getItem(t);return i?(e.push(i),this.getAncestors(i.parent_id,e)):e},u.prototype.isAncestor=function(t,e){var i=this.getItem(t);if(!i)return!1;var n=this.getItem(e),o=this.getItem(i.parent_id);return!!o&&(o==n||this.isAncestor(o,e))},u.prototype.moveItem=function(t,e){if(t===e)return!1;var i=this.getItem(t),n=this.getItem(e);if(this.isAncestor(n,i))return!1;var o=this._findElementIndex(n),r=parseInt(n.dataset.level),s=this.getParent(i);if(!s)return console.error("node parent not found by id, maybe id has changed"),!1;var a=r-parseInt(s.dataset.level);if(!n||!i)return!1;if(n==s)return!1;i.parent_id=e;var l=this.getChildren(i);if(l){l.unshift(i);for(var c=0;c<l.length;c++)l[c].parentNode.removeChild(l[c]);for(c=0;c<l.length;c++){var d=l[c],u=parseInt(d.dataset.level)+a;d.dataset.level=u}o=this._findElementIndex(n);var h=this._findElementLastChildIndex(o);-1==h&&(h=0);for(c=0;c<l.length;c++){d=l[c];this._insertInside(d,o,h+c-1,parseInt(d.dataset.level))}}return this._updateListBox(n),s&&this._updateListBox(s),!0},u.prototype.removeItem=function(t,e){var i=t;if("string"==typeof t&&(i=this.getItem(t)),!i)return!1;var n=this.getParent(i),o=null;if(e&&(o=this.getChildren(i)),this.root.removeChild(i),o)for(var r=0;r<o.length;r++)this.root.removeChild(o[r]);return n&&this._updateListBox(n),!0},u.prototype.updateItem=function(t,e){var i=this.getItem(t);if(!i)return!1;(i.data=e).id&&(i.id=e.id),e.content&&(i.title_element.querySelector(".incontent").innerHTML=e.content);return!0},u.prototype.updateItemId=function(t,e){var i=this.getItem(t);if(!i)return!1;var n=this.getChildren(t,!0);i.id=e;for(var o=0;o<n.length;++o){n[o].parent_id=e}return!0},u.prototype.clear=function(t){if(t)for(var e=this.root.querySelectorAll(".ltreeitem"),i=1;i<e.length;i++){var n=e[i];this.root.removeChild(n)}else this.root.innerHTML=""},u.prototype.getNodeByIndex=function(t){return this.root.querySelectorAll(".ltreeitem")[t]},u.prototype.unmarkAllAsSelected=function(){this.root.classList.remove("selected");var t=this.root.querySelectorAll(".ltreeitem.selected");if(t)for(var e=0;e<t.length;e++)t[e].classList.remove("selected");var i=this.root.querySelectorAll(".ltreeitem.semiselected");for(e=0;e<i.length;e++)i[e].classList.remove("semiselected")},u.prototype.isNodeSelected=function(t){return!!t.classList.contains("selected")},u.prototype.markAsSelected=function(t,e){if(!t.classList.contains("selected")){e||this.unmarkAllAsSelected(),t.classList.add("selected");for(var i=this.getParent(t),n=[];i&&-1==n.indexOf(i);)i.classList.add("semiselected"),n.push(i),i=this.getParent(i)}},u.prototype._updateListBox=function(e,t,i){if(e){var n=this;if(!e.listbox){var o=e.title_element.querySelector(".collapsebox"),r=LiteGUI.createLitebox(!0,function(t){n.onClickBox(t,e),LiteGUI.trigger(n.root,"item_collapse_change",{item:e,data:r.getValue()})});r.stopPropagation=!0,r.setEmpty(!0),o.appendChild(r),e.listbox=r}(t&&t.collapsed||i>=this.collapsed_depth)&&e.listbox.collapse();var s=this.getChildren(e.dataset.item_id);s&&(s.length?e.listbox.setEmpty(!1):e.listbox.setEmpty(!0))}},u.prototype.onClickBox=function(t,e){var i=this.getChildren(e);if(i)for(var n=0;n<i.length;++n){var o=i[n],r=this.getParent(o),s=!0;r&&(s=this._isNodeChildrenVisible(r)),s?o.classList.remove("hidden"):o.classList.add("hidden")}},LiteGUI.Tree=u}(),function(){function t(t,e){this._ctor(t,e)}t.title_height="20px",t.prototype._ctor=function(t,e){!e&&t&&t.constructor!==String&&(e=t,t=null),e=e||{},this.content=e.content||"";var i=this.root=document.createElement("div");t&&(i.id=t),i.className="litepanel "+(e.className||""),i.data=this;var n="";e.title&&(n+="<div class='panel-header'>"+e.title+"</div>"),n+="<div class='content'>"+this.content+"</div>",n+="<div class='panel-footer'></div>",i.innerHTML=n,e.title&&(this.header=this.root.querySelector(".panel-header")),this.content=this.root.querySelector(".content"),this.footer=this.root.querySelector(".panel-footer"),e.width&&(this.root.style.width=LiteGUI.sizeToCSS(e.width)),e.height&&(this.root.style.height=LiteGUI.sizeToCSS(e.height)),e.position&&(this.root.style.position="absolute",this.root.style.left=LiteGUI.sizeToCSS(e.position[0]),this.root.style.top=LiteGUI.sizeToCSS(e.position[1])),1==e.scroll&&(this.content.style.overflow="auto")},t.prototype.add=function(t){this.content.appendChild(t.root)},t.prototype.clear=function(){for(;this.content.firstChild;)this.content.removeChild(this.content.firstChild)},LiteGUI.Panel=t}(),function(){function u(t,e){if(e||t&&t.constructor===String){var i=t;(t=e||{}).id=i,console.warn("LiteGUI.Dialog legacy parameter, use options as first parameter instead of id.")}this._ctor(t)}u.MINIMIZED_WIDTH=200,u.title_height="20px",u.getDialog=function(t){var e=document.getElementById(t);return e?e.dialog:null},u.prototype._ctor=function(t){t=t||{};var e=this;this.width=t.width,this.height=t.height,this.minWidth=t.minWidth||150,this.minHeight=t.minHeight||100,this.content=t.content||"";var i=document.createElement("div");t.id&&(i.id=t.id),i.className="litedialog "+(t.className||""),i.data=this,i.dialog=this;var n="";if(t.title&&(n+="<div class='panel-header'>"+t.title+"</div><div class='buttons'>",t.minimize&&(n+="<button class='litebutton mini-button minimize-button'>-</button>",n+="<button class='litebutton mini-button maximize-button' style='display:none'></button>"),t.hide&&(n+="<button class='litebutton mini-button hide-button'></button>"),t.detachable&&(n+="<button class='litebutton mini-button detach-button'></button>"),(t.close||t.closable)&&(n+="<button class='litebutton mini-button close-button'>"+LiteGUI.special_codes.close+"</button>"),n+="</div>"),n+="<div class='content'>"+this.content+"</div>",n+="<div class='panel-footer'></div>",i.innerHTML=n,this.root=i,this.content=i.querySelector(".content"),this.footer=i.querySelector(".panel-footer"),t.fullcontent&&(this.content.style.width="100%",this.content.style.height=t.title?"calc( 100% - "+u.title_height+" )":"100%"),t.buttons)for(var o in t.buttons)this.addButton(t.buttons[o].name,t.buttons[o]);1==t.scroll&&(this.content.style.overflow="auto");var r=i.querySelector(".close-button");r&&r.addEventListener("click",this.close.bind(this));var s=i.querySelector(".maximize-button");s&&s.addEventListener("click",this.maximize.bind(this));var a=i.querySelector(".minimize-button");a&&a.addEventListener("click",this.minimize.bind(this));var l=i.querySelector(".hide-button");l&&l.addEventListener("click",this.hide.bind(this));var c=i.querySelector(".detach-button");if(c&&c.addEventListener("click",function(){e.detachWindow()}),this.enableProperties(t),this.root.addEventListener("DOMNodeInsertedIntoDocument",function(){e.on_attached_to_DOM&&e.on_attached_to_DOM(),e.on_resize&&e.on_resize()}),this.root.addEventListener("DOMNodeRemovedFromDocument",function(){e.on_detached_from_DOM&&e.on_detached_from_DOM()}),t.attach||t.parent){var d=null;t.parent&&(d="string"==typeof t.parent?document.querySelector(t.parent):t.parent),(d=d||LiteGUI.root).appendChild(this.root),this.center()}},u.prototype.add=function(t){this.content.appendChild(t.root||t)},u.prototype.enableProperties=function(t){t=t||{};var e=this,i=this.root;i.style.position="absolute",i.style.minWidth=this.minWidth+"px",i.style.minHeight=this.minHeight+"px",this.width&&(i.style.width=this.width+"px"),this.height&&("number"==typeof this.height?i.style.height=this.height+"px":-1!=this.height.indexOf("%")&&(i.style.height=this.height),this.content.style.height="calc( "+this.height+"px - 24px )"),i.style.boxShadow="0 0 3px black",t.draggable&&(this.draggable=!0,LiteGUI.draggable(i,i.querySelector(".panel-header"),function(){e.bringToFront()},null,function(){return!e.minimized})),t.resizable&&this.setResizable()},u.prototype.setResizable=function(){if(!this.resizable){var s=this.root;this.resizable=!0;var t=this.footer;t.style.minHeight="4px",t.classList.add("resizable");var a=document.createElement("div");a.className="resizable-corner",this.root.appendChild(a),t.addEventListener("mousedown",u),a.addEventListener("mousedown",u,!0);var l=[0,0],c=this,d=!1}function u(t){if("mousedown"==t.type)document.body.addEventListener("mousemove",u),document.body.addEventListener("mouseup",u),d=this==a,l[0]=t.pageX,l[1]=t.pageY;else if("mousemove"==t.type){var e=LiteGUI.getRect(s),i=e.width,n=i-(l[0]-t.pageX),o=e.height,r=o-(l[1]-t.pageY);d&&(s.style.width=n+"px"),s.style.height=r+"px",l[0]=t.pageX,l[1]=t.pageY,c.content.style.height="calc( 100% - 24px )",!c.on_resize||i==n&&o==r||c.on_resize(t,n,r)}else"mouseup"==t.type&&(document.body.removeEventListener("mousemove",u),document.body.removeEventListener("mouseup",u),d=!1);return t.preventDefault(),t.stopPropagation(),!1}},u.prototype.dockTo=function(t,e){if(t){var i=this.root;e=e||"full",t=t.content||t,i.style.top=0,i.style.left=0,i.style.boxShadow="0 0 0","full"==e?(i.style.position="relative",i.style.width="100%",i.style.height="100%",this.content.style.width="100%",this.content.style.height="calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.overflow="auto"):"left"==e||"right"==e?(i.style.position="absolute",i.style.top=0,i.style[e]=0,i.style.width=this.width+"px",i.style.height="100%",this.content.style.height="calc(100% - "+LiteGUI.Panel.title_height+")",this.content.style.overflow="auto","right"==e&&(i.style.left="auto",i.style.right=0)):"bottom"!=e&&"top"!=e||(i.style.width="100%",i.style.height=this.height+"px","bottom"==e&&(i.style.bottom=0,i.style.top="auto")),this.draggable&&LiteGUI.draggable(i),t.content?t.content.appendChild(i):"string"==typeof t&&!(t=document.querySelector(t))||t.appendChild(i)}},u.prototype.addButton=function(t,e){(e=e||{}).constructor===Function&&(e={callback:e});var i=this,n=document.createElement("button");return n.className="litebutton",n.innerHTML=t,e.className&&(n.className+=" "+e.className),this.root.querySelector(".panel-footer").appendChild(n),n.addEventListener("click",function(t){e.callback&&e.callback(this),e.close&&i.close()}),n},u.prototype.close=function(){LiteGUI.remove(this.root),LiteGUI.trigger(this,"closed",this),this.on_close&&this.on_close(),this.onclose&&console.warn("Dialog: Do not use onclose, use on_close instead"),this.dialog_window&&(this.dialog_window.close(),this.dialog_window=null)},u.prototype.highlight=function(t){t=t||100,this.root.style.outline="1px solid white";var e=this.root.ownerDocument;(e.defaultView||e.parentWindow).focus(),setTimeout(function(){this.root.style.outline=null}.bind(this),t)},u.minimized=[],u.prototype.minimize=function(){if(!this.minimized){this.minimized=!0,this.old_box=this.root.getBoundingClientRect(),this.root.querySelector(".content").style.display="none";var t=this.root.querySelector(".minimize-button");t&&(t.style.display="none");var e=this.root.querySelector(".maximize-button");e&&(e.style.display=""),this.root.style.width=LiteGUI.Dialog.MINIMIZED_WIDTH+"px",LiteGUI.bind(this,"closed",function(){LiteGUI.Dialog.minimized.splice(LiteGUI.Dialog.minimized.indexOf(this),1),LiteGUI.Dialog.arrangeMinimized()}),LiteGUI.Dialog.minimized.push(this),LiteGUI.Dialog.arrangeMinimized(),LiteGUI.trigger(this,"minimizing")}},u.arrangeMinimized=function(){for(var t in LiteGUI.Dialog.minimized){var e=LiteGUI.Dialog.minimized[t],i=e.root.parentNode.getBoundingClientRect().height-20;e.root.style.left=LiteGUI.Dialog.MINIMIZED_WIDTH*t,e.root.style.top=i+"px"}},u.prototype.maximize=function(){if(this.minimized){this.minimized=!1,this.root.querySelector(".content").style.display="",LiteGUI.draggable(this.root),this.root.style.left=this.old_box.left+"px",this.root.style.top=this.old_box.top+"px",this.root.style.width=this.old_box.width+"px",this.root.style.height=this.old_box.height+"px";var t=this.root.querySelector(".minimize-button");t&&(t.style.display="");var e=this.root.querySelector(".maximize-button");e&&(e.style.display="none"),LiteGUI.Dialog.minimized.splice(LiteGUI.Dialog.minimized.indexOf(this),1),LiteGUI.Dialog.arrangeMinimized(),LiteGUI.trigger(this,"maximizing")}},u.prototype.makeModal=function(){LiteGUI.showModalBackground(!0),LiteGUI.modalbg_div.appendChild(this.root),this.show(),this.center(),LiteGUI.bind(this,"closed",function(t){LiteGUI.showModalBackground(!1)})},u.prototype.bringToFront=function(){var t=this.root.parentNode;t.removeChild(this.root),t.appendChild(this.root)},u.prototype.show=function(t,e){if(!this.root.parentNode){if(e){var i=e.ownerDocument;(i.querySelector(".litegui-wrap")||i.body).appendChild(this.root),(i.defaultView||i.parentWindow).focus()}else LiteGUI.add(this);this.center()}this.detach_window||(this.root.style.display="",LiteGUI.trigger(this,"shown"))},u.prototype.hide=function(t){this.root.style.display="none",LiteGUI.trigger(this,"hidden")},u.prototype.fadeIn=function(t){t=t||1e3,this.root.style.display="",this.root.style.opacity=0;var e=this;setTimeout(function(){e.root.style.transition="opacity "+t+"ms",e.root.style.opacity=1},100)},u.prototype.setPosition=function(t,e){this.root.parentNode||console.warn("LiteGUI.Dialog: Cannot set position of dialog if it is not in the DOM"),this.root.position="absolute",this.root.style.left=t+"px",this.root.style.top=e+"px"},u.prototype.setSize=function(t,e){this.root.style.width="number"==typeof t?t+"px":t,this.root.style.height="number"==typeof e?e+"px":e},u.prototype.setTitle=function(t){this.header&&(this.header.innerHTML=t)},u.prototype.center=function(){if(this.root.parentNode){this.root.position="absolute";var t=this.root.offsetWidth,e=this.root.offsetHeight,i=this.root.parentNode.offsetWidth,n=this.root.parentNode.offsetHeight;this.root.style.left=Math.floor(.5*(i-t))+"px",this.root.style.top=Math.floor(.5*(n-e))+"px"}},u.prototype.adjustSize=function(t,e){if(t=t||0,this.content.style.height="auto",0!=this.content.offsetHeight||e){var i=0,n=this.root.querySelector(".panel-footer");n&&(i+=n.offsetHeight);var o=this.content.offsetWidth,r=this.content.offsetHeight+20+t+i;this.setSize(o,r)}else{var s=this;setTimeout(function(){s.adjustSize(t,!0)},1)}},u.prototype.clear=function(){this.content.innerHTML=""},u.prototype.detachWindow=function(t,e){if(!this.dialog_window){var i=this.root.getClientRects()[0],n=i.width,o=i.height,r="Window",s=this.root.querySelector(".panel-header");s&&(r=s.textContent);var a=window.open("","","width="+n+", height="+o+", location=no, status=no, menubar=no, titlebar=no, fullscreen=yes");a.document.write("<head><title>"+r+"</title>"),this.dialog_window=a;for(var l=document.querySelectorAll("link[rel='stylesheet'],style"),c=0;c<l.length;c++)a.document.write(l[c].outerHTML);a.document.write("</head><body></body>"),a.document.close();return a.onbeforeunload=function(){var t=LiteGUI.windows.indexOf(a);-1!=t&&LiteGUI.windows.splice(t,1),e&&e()},a.document.body.appendChild(this.content),this.root.style.display="none",this._old_height=this.content.style.height,this.content.style.height="100%",LiteGUI.windows.push(a),t&&t(),a}},u.prototype.reattachWindow=function(t){if(this.dialog_window){this.root.appendChild(this.content),this.root.style.display="",this.content.style.height=this._old_height,delete this._old_height,this.dialog_window.close();var e=LiteGUI.windows.indexOf(this.dialog_window);-1!=e&&LiteGUI.windows.splice(e,1),this.dialog_window=null}},u.showAll=function(){for(var t=document.body.querySelectorAll("litedialog"),e=0;e<t.length;e++){t[e].dialog.show()}},u.hideAll=function(){for(var t=document.body.querySelectorAll("litedialog"),e=0;e<t.length;e++){t[e].dialog.hide()}},u.closeAll=function(){for(var t=document.body.querySelectorAll("litedialog"),e=0;e<t.length;e++){t[e].dialog.close()}},LiteGUI.Dialog=u}(),function(){function t(t){t=t||{},this.root=document.createElement("table"),this.root.classList.add("litetable"),this.columns=[],this.column_fields=[],this.rows=[],this.data=[],this._must_update_header=!0,t.colums&&this.setColumns(t.colums),t.scrollable&&(this.root.style.overflow="auto"),t.height&&(this.root.style.height=LiteGUI.sizeToCSS(t.height)),t.columns&&this.setColumns(t.columns),t.rows&&this.setRows(t.data)}t.prototype.setRows=function(t,e){this.data=t,this.updateContent(e)},t.prototype.addRow=function(t,e){for(var i=document.createElement("tr"),n=0;n<this.column_fields.length;++n){var o=document.createElement("td"),r=null;void 0===(r=t.constructor===Array?t[n]:t[this.column_fields[n]])&&(r=""),o.innerHTML=r;var s=this.columns[n];if(void 0===s)break;s.className&&(o.className=s.className),s.width&&(o.style.width=s.width),i.appendChild(o)}return this.root.appendChild(i),this.rows.push(i),e||this.data.push(t),i},t.prototype.updateRow=function(t,e){this.data[t]=e;var i=this.rows[t];if(i){for(var n=i.querySelectorAll("td"),o=0;o<n.length;++o){var r=this.columns[o],s=null;void 0===(s=e.constructor===Array?e[o]:e[r.field])&&(s=""),n[o].innerHTML=s}return i}},t.prototype.updateCell=function(t,e,i){var n=this.rows[t];if(n&&(e=n.childNodes[e]))return e.innerHTML=i,e},t.prototype.setColumns=function(t){this.columns.length=0,this.column_fields.length=0;for(var e=Math.floor(100/t.length).toFixed(1)+"%",i=[],n=0;n<t.length;++n){var o=t[n];if(null!=o){o.constructor!==String&&o.constructor!==Number||(o={name:String(o)});var r={name:o.name||"",width:LiteGUI.sizeToCSS(o.width||e),field:(o.field||o.name||"").toLowerCase(),className:o.className};n==t.length-1?r.width=" calc( 100% - ( "+i.join(" + ")+" ) )":i.push(r.width),this.columns.push(r),this.column_fields.push(r.field)}}this._must_update_header=!0,this.updateContent()},t.prototype.updateContent=function(t){if(this.root.innerHTML="",this._must_update_header){this.header=document.createElement("tr");for(var e=0;e<this.columns.length;++e){var i=this.columns[e],n=document.createElement("th");n.innerHTML=i.name,i.width&&(n.style.width=i.width),i.th=n,this.header.appendChild(n)}this._must_update_header=!1}if(this.root.appendChild(this.header),this.data)if(this.data.length!=this.rows.length&&(t=!1),t)for(e=0;e<this.rows.length;++e){var o=this.data[e],r=this.updateRow(e,o);this.root.appendChild(r)}else for(e=this.rows.length=0;e<this.data.length;++e){var s=this.data[e];this.addRow(s,!0)}},LiteGUI.Table=t}(),Inspector.prototype.getValues=function(){var t={};for(var e in this.widgets_by_name)t[e]=this.widgets_by_name[e].getValue();return t},Inspector.prototype.setValues=function(t){for(var e in t)this.widgets_by_name[e]&&this.widgets_by_name[e].setValue(t[e])},Inspector.prototype.appendTo=function(t,e){t&&(t.constructor===String&&(t=document.querySelector(t)),t&&(e?t.insertBefore(this.root,t.firstChild):t.appendChild(this.root)))},Inspector.prototype.clear=function(){for(purgeElement(this.root,!0);this.root.hasChildNodes();)this.root.removeChild(this.root.lastChild);this.root.className=this.className,this.row_number=0,this.values={},this.widgets=[],this.widgets_by_name={},this.sections=[],this.current_section=null,this._current_container=null,this._current_container_stack=null,this.addContainer()},Inspector.prototype.refresh=function(){this.on_refresh&&this.on_refresh()},Inspector.prototype.append=function(t,e){var i=(e=e||{}).widget_parent||this._current_container||this.root;e.replace?e.replace.parentNode.replaceChild(t,e.replace):(t.section=this.current_section,i.appendChild(t))},Inspector.prototype.pushContainer=function(t){if(this._current_container_stack){if(-1!=this._current_container_stack.indexOf(t))return void console.warn("Container already in the stack");this._current_container_stack.push(t)}else this._current_container_stack=[t];this._current_container=t},Inspector.prototype.isContainerInStack=function(t){return!!this._current_container_stack&&-1!=this._current_container_stack.indexOf(t)},Inspector.prototype.popContainer=function(t){if(this.row_number=0,this._current_container_stack&&this._current_container_stack.length){if(t)for(var e=this._current_container_stack.pop();e&&e!=t;)e=this._current_container_stack.pop();else this._current_container_stack.pop();this._current_container=this._current_container_stack[this._current_container_stack.length-1]}else this._current_container=null},Inspector.prototype.setup=function(t){for(var e in t){var i=t[e];this.add(i.type,i.name,i.value,i.options)}},Inspector.prototype.getWidget=function(t){return null!==t&&t.constructor===Number?this.widgets[t]:this.widgets_by_name[t]},Inspector.prototype.inspectInstance=function(t,e,i,n){if(t){e=e||(t.getProperties?t.getProperties():this.collectProperties(t));var o=t.constructor;!i&&o.properties&&(i=o.properties);var r={};if(t.getInspectorProperties)r=t.getInspectorProperties();else for(var s in e)if(i&&i[s])r[s]=h(i[s]);else{var a=e[s];if(o["@"+s]){var l=o["@"+s];if(l&&null===l.widget)continue;r[s]=h(l)}else if(t["@"+s])r[s]=t["@"+s];else{if(null==a)continue;switch(a.constructor){case Number:r[s]={type:"number",step:.1};break;case String:r[s]={type:"string"};break;case Boolean:r[s]={type:"boolean"};break;default:if(a&&(a.constructor===Array||a.constructor.BYTES_PER_ELEMENT)){var c=null!=a[0]&&a[0].constructor===Number;switch(a.length){case 2:r[s]={type:c?"vec2":"Array",step:.1};break;case 3:r[s]={type:c?"vec3":"Array",step:.1};break;case 4:r[s]={type:c?"vec4":"Array",step:.1};break;default:r[s]={type:"Array"}}}}}}if(n)for(var s in n)delete r[n[s]];if(o.properties_order){var d={};for(var s in o.properties_order){var u=o.properties_order[s];r[u]?d[u]=r[u]:console.warn("property not found in instance:",u)}for(var s in r)d[s]||(d[s]=r[s]);r=d}return this.showProperties(t,r)}function h(t,e){for(var i in e=e||{},t)e[i]=t[i];return e}},Inspector.prototype.collectProperties=function(t){var e={};for(var i in t)if("_"!=i[0]&&"@"!=i[0]&&"jQuery"!=i.substr(0,6)){var n=t[i];n&&n.constructor==Function&&!t.constructor["@"+i]||(e[i]=n)}return e},Inspector.prototype.showProperties=function(t,e){for(var i in e){var n=i,o=e[i];if(o){if(o.constructor===String&&(o={type:o}),o.name&&(n=o.name),!o.callback){var r={instance:t,name:n,options:o};"function"==o.type||(o.callback=Inspector.assignValue.bind(r))}if(!o.callback_update){r={instance:t,name:n};o.callback_update=function(){return this.instance[this.name]}.bind(r)}o.instance=t,o.varname=n;var s=o.widget||o.type||"string";this.on_addProperty&&this.on_addProperty(s,t,n,t[n],o),this.add(s,n,t[n],o)}}if(t.constructor.widgets)for(var i in t.constructor.widgets){var a=t.constructor.widgets[i];this.add(a.widget,a.name,a.value,a)}t.onShowProperties&&t.onShowProperties(this),t.constructor.onShowProperties&&t.constructor.onShowProperties(t,this)},Inspector.assignValue=function(t){var e=this.instance,i=e[this.name];if(null==i||null==t||"enum"==this.options.type)e[this.name]=t;else if("number"==typeof i)e[this.name]=parseFloat(t);else if("string"==typeof i)e[this.name]=t;else if(!(t&&t.length&&i&&i.length)||Object.getOwnPropertyDescriptor(e,this.name)&&Object.getOwnPropertyDescriptor(e,this.name).set||Object.getOwnPropertyDescriptor(e.__proto__,this.name)&&Object.getOwnPropertyDescriptor(e.__proto__,this.name).set)e[this.name]=t;else for(var n=0;n<t.length;++n)i[n]=t[n]},Inspector.prototype.createWidget=function(t,e,i){i=i||{},e=null==e?"":e;var n=document.createElement("DIV");n.className="widget "+(i.className||""),n.inspector=this,n.options=i,n.name=t,this.row_number+=this.widgets_per_row,this.row_number%2==0&&(n.className+=" even");var o=i.width||this.widgets_width;o&&(n.style.width=LiteGUI.sizeToCSS(o),n.style.width||(n.style.width="calc("+LiteGUI.sizeToCSS(o)+")"),n.style.minWidth="auto");var r=i.height||this.height;r&&(n.style.height=LiteGUI.sizeToCSS(r),n.style.height||(n.style.height="calc("+LiteGUI.sizeToCSS(r)+")"),n.style.minHeight="auto"),this.widgets.push(n),(i.widget_name||t)&&(this.widgets_by_name[i.widget_name||t]=n),1!=this.widgets_per_row&&(i.width||(n.style.width=(100/this.widgets_per_row).toFixed(2)+"%"),n.style.display="inline-block");var s="",a="";if(null!=t&&(this.name_width||i.name_width)&&!this.one_line){var l=LiteGUI.sizeToCSS(i.name_width||this.name_width);s="style='width: calc("+l+" - 0px); width: -webkit-calc("+l+" - 0px); width: -moz-calc("+l+" - 0px); '",a="style='width: calc( 100% - "+l+"); width: -webkit-calc(100% - "+l+"); width: -moz-calc( 100% - "+l+"); '"}i.name_width&&(s="style='width: "+LiteGUI.sizeToCSS(i.name_width)+" '"),i.content_width&&(a="style='width: "+LiteGUI.sizeToCSS(i.content_width)+" '");var c="",d="",u=this.one_line?"":"<span class='filling'></span>";i.pretitle&&(d=i.pretitle);var h="wcontent ",p=t;if(i.title&&(p=i.title),null==t?h+=" full":c+=""===t?"<span class='wname' title='"+p+"' "+s+">"+d+"</span>":"<span class='wname' title='"+p+"' "+s+">"+d+t+u+"</span>",e.constructor===String||e.constructor===Number||e.constructor===Boolean)n.innerHTML=c+"<span class='info_content "+h+"' "+a+">"+e+"</span>";else{n.innerHTML=c+"<span class='info_content "+h+"' "+a+"></span>";var f=n.querySelector("span.info_content");f&&f.appendChild(e)}return n.content=n.querySelector("span.info_content"),n.remove=function(){this.parentNode&&this.parentNode.removeChild(this)},n},Inspector.onWidgetChange=function(t,e,i,n,o,r){var s=t.section;n.skip_wchange||(s&&LiteGUI.trigger(s,"wbeforechange",i),LiteGUI.trigger(t,"wbeforechange",i)),this.values[e]=i;var a=void 0;return n.callback&&(a=o?n.callback.apply(t,i):n.callback.call(t,i,r)),n.skip_wchange||(s&&LiteGUI.trigger(s,"wchange",i,t),LiteGUI.trigger(t,"wchange",i,t)),this.onchange&&this.onchange(e,i,t),a},Inspector.widget_constructors={null:"addNull",title:"addTitle",info:"addInfo",default:"addDefault",number:"addNumber",slider:"addSlider",string:"addString",text:"addString",textarea:"addTextarea",color:"addColor",boolean:"addCheckbox",checkbox:"addCheckbox",icon:"addIcon",vec2:"addVector2",vector2:"addVector2",vec3:"addVector3",vector3:"addVector3",vec4:"addVector4",vector4:"addVector4",enum:"addCombo",dropdown:"addCombo",combo:"addCombo",button:"addButton",buttons:"addButtons",file:"addFile",line:"addLine",list:"addList",tree:"addTree",datatree:"addDataTree",pad:"addPad",array:"addArray",separator:"addSeparator"},Inspector.registerWidget=function(t,e){var i="add"+t.charAt(0).toUpperCase()+t.slice(1);Inspector.prototype[i]=e,Inspector.widget_constructors[t]=i},Inspector.prototype.add=function(t,e,i,n){if(!t)throw"Inspector: no type specified";1==arguments.length&&"object"==typeof t&&(t=(n=t).type,e=n.name,i=n.value);var o=LiteGUI.Inspector.widget_constructors[t.toLowerCase()];if(o){if(o.constructor===String&&(o=LiteGUI.Inspector.prototype[o]),o&&o.constructor===Function)return n&&n.constructor===Function&&(n={callback:n}),o.call(this,e,i,n)}else console.warn("LiteGUI.Inspector do not have a widget called",t)},Inspector.prototype.getValue=function(t){return this.values[t]},Inspector.prototype.applyOptions=function(t,e){t&&e&&(e.className&&(t.className+=" "+e.className),e.id&&(t.id=e.id),e.width&&(t.style.width=LiteGUI.sizeToCSS(e.width)),e.height&&(t.style.height=LiteGUI.sizeToCSS(e.height)))},Inspector.prototype.addSeparator=function(){var t=document.createElement("DIV");return t.className="separator",this.append(t),t},Inspector.prototype.addNull=function(t,e,i){return null},Inspector.prototype.addDefault=function(t,e,i){return null==e?null:e.constructor===Boolean?this.addCheckbox(t,e,i):e.constructor===String?this.addString(t,e,i):e.constructor===Number?this.addNumber(t,e,i):4==e.length?this.addVector4(t,e,i):3==e.length?this.addVector3(t,e,i):2==e.length?this.addVector2(t,e,i):null},Inspector.prototype.addString=function(i,t,n){n=this.processOptions(n),t=t||"";var o=this;this.values[i]=t;var e="text";n.password&&(e="password");var r=n.focus?"autofocus":"",s=this.createWidget(i,"<span class='inputfield full "+(n.disabled?"disabled":"")+"'><input type='"+e+"' tabIndex='"+this.tab_index+"' "+r+" class='text string' value='"+t+"' "+(n.disabled?"disabled":"")+"/></span>",n),a=s.querySelector(".wcontent input");return n.placeHolder&&a.setAttribute("placeHolder",n.placeHolder),"right"==n.align&&(a.style.direction="rtl"),a.addEventListener(n.immediate?"keyup":"change",function(t){var e=Inspector.onWidgetChange.call(o,s,i,t.target.value,n);void 0!==e&&(this.value=e)}),n.callback_enter&&a.addEventListener("keydown",function(t){if(13==t.keyCode){Inspector.onWidgetChange.call(o,s,i,t.target.value,n);n.callback_enter(),t.preventDefault()}}),this.tab_index+=1,s.setIcon=function(t){t?(a.style.background="transparent url('"+t+"') no-repeat left 4px center",a.style.paddingLeft="1.7em"):(a.style.background="",a.style.paddingLeft="")},n.icon&&s.setIcon(n.icon),s.setValue=function(t,e){void 0!==t&&t!==a.value&&(a.value=t,e||LiteGUI.trigger(a,"change"))},s.getValue=function(){return a.value},s.focus=function(){this.querySelector("input").focus()},s.disable=function(){a.disabled=!0},s.enable=function(){a.disabled=!1},this.append(s,n),this.processElement(s,n),s},Inspector.prototype.addStringButton=function(i,t,n){n=this.processOptions(n),void 0===t&&(t="");var o=this;this.values[i]=t;var r=this.createWidget(i,"<span class='inputfield button'><input type='text' tabIndex='"+this.tab_index+"' class='text string' value='"+t+"' "+(n.disabled?"disabled":"")+"/></span><button class='micro'>"+(n.button||"...")+"</button>",n),s=r.querySelector(".wcontent input");s.addEventListener("change",function(t){var e=Inspector.onWidgetChange.call(o,r,i,t.target.value,n);void 0!==e&&(this.value=e)}),r.setIcon=function(t){t?(s.style.background="transparent url('"+t+"') no-repeat left 4px center",s.style.paddingLeft="1.7em"):(s.style.background="",s.style.paddingLeft="")},n.icon&&r.setIcon(n.icon);var e=r.querySelector(".wcontent button");e.addEventListener("click",function(t){n.callback_button&&n.callback_button.call(r,s.value,t)}),n.button_width&&(e.style.width=LiteGUI.sizeToCSS(n.button_width),r.querySelector(".inputfield").style.width="calc( 100% - "+e.style.width+" - 6px)");return this.tab_index+=1,this.append(r,n),r.setValue=function(t,e){s.value=t,e||LiteGUI.trigger(s,"change")},r.disable=function(){s.disabled=!0,e.disabled=!0},r.enable=function(){s.disabled=!1,e.disabled=!1},r.getValue=function(){return s.value},r.focus=function(){LiteGUI.focus(s)},this.processElement(r,n),r},Inspector.prototype.addTextarea=function(e,i,n){n=this.processOptions(n),i=i||"";var o=this;this.values[e]=i;var r=this.createWidget(e,"<span class='inputfield textarea "+(n.disabled?"disabled":"")+"'><textarea tabIndex='"+this.tab_index+"' "+(n.disabled?"disabled":"")+"></textarea></span>",n);this.tab_index++;var s=r.querySelector(".wcontent textarea");return s.value=i,s.addEventListener(n.immediate?"keyup":"change",function(t){Inspector.onWidgetChange.call(o,r,e,t.target.value,n,!1,t)}),n.callback_keydown&&s.addEventListener("keydown",n.callback_keydown),n.height&&(s.style.height="calc( "+LiteGUI.sizeToCSS(n.height)+" - 5px )"),this.append(r,n),r.setValue=function(t,e){void 0!==t&&t!=s.value&&(i=t,s.value=t,e||LiteGUI.trigger(s,"change"))},r.getValue=function(t){return s.value},r.focus=function(){LiteGUI.focus(s)},r.disable=function(){s.disabled=!0},r.enable=function(){s.disabled=!1},this.processElement(r,n),r},Inspector.prototype.addNumber=function(i,t,n){n=this.processOptions(n),t=t||0;var o=this;this.values[i]=t;var r=this.createWidget(i,"",n);this.append(r,n),n.extraclass="full",n.tab_index=this.tab_index,n.full=!0,n.precision=void 0!==n.precision?n.precision:2,n.step=void 0===n.step?0==n.precision?1:.1:n.step,this.tab_index++;var s=null;(s=new LiteGUI.Dragger(t,n)).root.style.width="calc( 100% - 1px )",r.querySelector(".wcontent").appendChild(s.root),s.root.addEventListener("start_dragging",function(t){this.callback_before&&this.callback_before.call(r)}.bind(n)),r.dragger=s,n.disabled&&s.input.setAttribute("disabled","disabled");var a=r.querySelector("input");return a.addEventListener("change",function(t){if(LiteGUI.trigger(r,"wbeforechange",t.target.value),o.values[i]=t.target.value,n.callback){var e=n.callback.call(r,parseFloat(t.target.value));"number"==typeof e&&(this.value=e)}LiteGUI.trigger(r,"wchange",t.target.value),o.onchange&&o.onchange(i,t.target.value,r)}),r.setValue=function(t,e){void 0!==t&&(t=parseFloat(t),n.precision&&(t=t.toFixed(n.precision)),t+=n.units||"",a.value!=t&&(a.value=t,e||LiteGUI.trigger(a,"change")))},r.setRange=function(t,e){s.setRange(t,e)},r.getValue=function(){return parseFloat(a.value)},r.focus=function(){LiteGUI.focus(a)},r.disable=function(){a.disabled=!0},r.enable=function(){a.disabled=!1},this.processElement(r,n),r},Inspector.prototype.addVector2=function(r,t,s){(s=this.processOptions(s)).step||(s.step=.1),t=t||[0,0];var a=this;this.values[r]=t;var l=this.createWidget(r,"",s);s.step=s.step||.1,s.tab_index=this.tab_index,s.full=!0,this.tab_index++;var e=l.querySelector(".wcontent"),i=new LiteGUI.Dragger(t[0],s);i.root.style.marginLeft=0,i.root.style.width="calc( 50% - 1px )",e.appendChild(i.root),s.tab_index=this.tab_index,this.tab_index++;var n=new LiteGUI.Dragger(t[1],s);function o(t){this.callback_before&&this.callback_before(t)}n.root.style.width="calc( 50% - 1px )",e.appendChild(n.root),l.draggers=[i,n],LiteGUI.bind(i.root,"start_dragging",o.bind(s)),LiteGUI.bind(n.root,"start_dragging",o.bind(s));for(var c=l.querySelectorAll("input"),d=0;d<c.length;++d)c[d].addEventListener("change",function(t){for(var e=[],i=c,n=0;n<i.length;n++)e.push(parseFloat(i[n].value));if(LiteGUI.trigger(l,"wbeforechange",[e]),a.values[r]=e,s.callback){var o=s.callback.call(l,e);if("object"==typeof o&&2<=o.length){for(n=0;n<i.length;n++)i[n].value=o[n];e=o}}LiteGUI.trigger(l,"wchange",[e]),a.onchange&&a.onchange(r,e,l)});return this.append(l,s),l.setValue=function(t,e){t&&(i.getValue()!=t[0]&&i.setValue(t[0],!0),n.getValue()!=t[1]&&n.setValue(t[1],e))},l.setRange=function(t,e){i.setRange(t,e),n.setRange(t,e)},this.processElement(l,s),l},Inspector.prototype.addVector3=function(r,t,s){(s=this.processOptions(s)).step||(s.step=.1),t=t||[0,0,0];var a=this;this.values[r]=t;var l=this.createWidget(r,"",s);s.step=s.step||.1,s.tab_index=this.tab_index,s.full=!0,this.tab_index++;var i=new LiteGUI.Dragger(t[0],s);i.root.style.marginLeft=0,i.root.style.width="calc( 33% - 1px )",l.querySelector(".wcontent").appendChild(i.root),s.tab_index=this.tab_index,this.tab_index++;var n=new LiteGUI.Dragger(t[1],s);n.root.style.width="calc( 33% - 1px )",l.querySelector(".wcontent").appendChild(n.root),s.tab_index=this.tab_index,this.tab_index++;var o=new LiteGUI.Dragger(t[2],s);function e(t){this.callback_before&&this.callback_before()}o.root.style.width="calc( 33% - 1px )",l.querySelector(".wcontent").appendChild(o.root),l.draggers=[i,n,o],i.root.addEventListener("start_dragging",e.bind(s)),n.root.addEventListener("start_dragging",e.bind(s)),o.root.addEventListener("start_dragging",e.bind(s));for(var c=l.querySelectorAll("input"),d=0;d<c.length;++d)c[d].addEventListener("change",function(t){for(var e=[],i=c,n=0;n<i.length;n++)e.push(parseFloat(i[n].value));if(LiteGUI.trigger(l,"wbeforechange",[e]),a.values[r]=e,s.callback){var o=s.callback.call(l,e);if("object"==typeof o&&3<=o.length){for(n=0;n<i.length;n++)i[n].value=o[n];e=o}}LiteGUI.trigger(l,"wchange",[e]),a.onchange&&a.onchange(r,e,l)});return this.append(l,s),l.setValue=function(t,e){t&&(i.setValue(t[0],!0),n.setValue(t[1],!0),o.setValue(t[2],e))},l.setRange=function(t,e){i.setRange(t,e),n.setRange(t,e),o.setRange(t,e)},this.processElement(l,s),l},Inspector.prototype.addVector4=function(r,t,s){(s=this.processOptions(s)).step||(s.step=.1),t=t||[0,0,0];var a=this;this.values[r]=t;var l=this.createWidget(r,"",s);s.step=s.step||.1,s.tab_index=this.tab_index,s.full=!0,this.tab_index++;for(var n=l.draggers=[],e=0;e<4;e++){var i=new LiteGUI.Dragger(t[e],s);i.root.style.marginLeft=0,i.root.style.width="calc( 25% - 1px )",l.querySelector(".wcontent").appendChild(i.root),s.tab_index=this.tab_index,this.tab_index++,i.root.addEventListener("start_dragging",o.bind(s)),n.push(i)}function o(t){this.callback_before&&this.callback_before()}var c=l.querySelectorAll("input");for(e=0;e<c.length;++e)c[e].addEventListener("change",function(t){for(var e=[],i=c,n=0;n<i.length;n++)e.push(parseFloat(i[n].value));if(LiteGUI.trigger(l,"wbeforechange",[e]),a.values[r]=e,s.callback){var o=s.callback.call(l,e);if("object"==typeof o&&4<=o.length){for(n=0;n<i.length;n++)i[n].value=o[n];e=o}}LiteGUI.trigger(l,"wchange",[e]),a.onchange&&a.onchange(r,e,l)});return this.append(l,s),l.setValue=function(t,e){if(t)for(var i=0;i<n.length;i++)n[i].setValue(t[i],e)},l.setRange=function(t,e){for(var i in n)n[i].setRange(t,e)},this.processElement(l,s),l},Inspector.prototype.addPad=function(a,t,l){(l=this.processOptions(l)).step||(l.step=.1),t=t||[0,0];var c=this;this.values[a]=t;var d=this.createWidget(a,"",l);l.step=l.step||.1,l.tab_index=this.tab_index,l.full=!0,this.tab_index++;var u=l.minx||l.min||0,h=l.miny||l.min||0,p=l.maxx||l.max||1,f=l.maxy||l.max||1,e=d.querySelector(".wcontent"),g=document.createElement("div");g.className="litepad",e.appendChild(g),g.style.width="100%",g.style.height="100px",l.background&&(g.style.backgroundImage="url('"+l.background+"')",g.style.backgroundSize="100%",g.style.backgroundRepeat="no-repeat");var v=document.createElement("div");v.className="litepad-handler",g.appendChild(v),l.tab_index=this.tab_index,this.tab_index++;return g._onMouseEvent=function(t){var e=g.getBoundingClientRect();if(t.mousex=t.pageX-e.left,t.mousey=t.pageY-e.top,t.preventDefault(),t.stopPropagation(),"mousedown"==t.type)document.body.addEventListener("mousemove",g._onMouseEvent),document.body.addEventListener("mouseup",g._onMouseEvent),0;else if("mousemove"==t.type){var i=t.mousex/e.width,n=t.mousey/e.height,o=[i=i*(p-u)+u,n=n*(f-h)+u];if(LiteGUI.trigger(d,"wbeforechange",[o]),d.setValue(o),l.callback){var r=l.callback.call(d,o);if(r&&2<=r.length)for(var s=0;s<elems.length;s++)d.setValue(r)}LiteGUI.trigger(d,"wchange",[o]),c.onchange&&c.onchange(a,o,d)}else"mouseup"==t.type&&(document.body.removeEventListener("mousemove",g._onMouseEvent),document.body.removeEventListener("mouseup",g._onMouseEvent));return!0},g.addEventListener("mousedown",g._onMouseEvent),d.setValue=function(t,e){if(void 0!==t){var i=g.getBoundingClientRect(),n=(t[0]-u)/(p-u),o=(t[1]-h)/(f-h);n=Math.max(0,Math.min(n,1)),o=Math.max(0,Math.min(o,1));var r=(i.width-10)/i.width*100,s=(i.height-10)/i.height*100;v.style.left=(n*r).toFixed(1)+"%",v.style.top=(o*s).toFixed(1)+"%"}},this.append(d,l),d.setValue(t),this.processElement(d,l),d},Inspector.prototype.addInfo=function(t,e,i){i=this.processOptions(i),e=null==e?"":e;var n=null;null!=t?n=this.createWidget(t,e,i):(n=document.createElement("div"),i.className&&(n.className=i.className),void 0!==e.nodeName?(n.innerHTML="<span class='winfo'></span>",n.childNodes[0].appendChild(e)):n.innerHTML="<span class='winfo'>"+e+"</span>");var o=n.querySelector(".winfo")||n.querySelector(".wcontent");i.callback&&n.addEventListener("click",i.callback.bind(n)),n.setValue=function(t){void 0!==t&&o&&(o.innerHTML=t)};var r=n.querySelector("span.info_content");return r=r||n.querySelector(".winfo"),i.width&&(n.style.width=LiteGUI.sizeToCSS(i.width),n.style.display="inline-block",t||(o.style.margin="2px")),i.height&&(r.style.height=LiteGUI.sizeToCSS(i.height),r.style.overflow="auto"),n.scrollToBottom=function(){r.scrollTop=r.offsetTop},n.add=function(t){r.appendChild(t)},this.append(n,i),this.processElement(n,i),n},Inspector.prototype.addSlider=function(i,n,o){void 0===(o=this.processOptions(o)).min&&(o.min=0),void 0===o.max&&(o.max=1),void 0===o.step&&(o.step=.01);var r=this;null==n&&(n=0),this.values[i]=n;var s=this.createWidget(i,"<span class='inputfield full'>\t\t\t\t<input tabIndex='"+this.tab_index+"' type='text' class='slider-text fixed nano' value='"+n+"' /><span class='slider-container'></span></span>",o),t=s.querySelector(".slider-container"),a=new LiteGUI.Slider(n,o);t.appendChild(a.root);var e=s.querySelector(".slider-text");return e.addEventListener("change",function(t){var e=parseFloat(this.value);n=e,a.setValue(e),Inspector.onWidgetChange.call(r,s,i,e,o)}),a.onChange=function(t){e.value=t,Inspector.onWidgetChange.call(r,s,i,t,o)},this.append(s,o),s.setValue=function(t,e){void 0!==t&&(n=t,a.setValue(t,e))},s.getValue=function(){return n},this.processElement(s,o),s},Inspector.prototype.addCheckbox=function(i,n,t){t=this.processOptions(t),n=!!n;var o=this;this.values[i]=n;var e=t.label_on||t.label||"on",r=t.label_off||t.label||"off",s=n?e:r,a=this.createWidget(i,"<span class='inputfield'><span tabIndex='"+this.tab_index+"' class='fixed flag checkbox "+(n?"on":"off")+"'>"+s+"</span></span>",t);this.tab_index++;var l=a.querySelector(".wcontent .checkbox");return l.addEventListener("keypress",function(t){32==t.keyCode&&LiteGUI.trigger(this,"click")}),a.addEventListener("click",function(){n=!n,a.querySelector("span.flag").innerHTML=n?e:r,n?l.classList.add("on"):l.classList.remove("on"),Inspector.onWidgetChange.call(o,a,i,n,t)}),a.getValue=function(){return n},a.setValue=function(t,e){void 0!==t&&(n=t,o.values[i]==t||e||LiteGUI.trigger(l,"click"))},this.append(a,t),this.processElement(a,t),a},Inspector.prototype.addFlags=function(i,t,e){var n={};for(var o in i)n[o]=i[o];if(t)for(var o in t)void 0===n[o]&&(n[o]=!!t[o]);for(var o in n){var r={};for(var s in e)r[s]=e[s];r.callback=function(e){return function(t){i[e]=t}}(o),this.addCheckbox(o,n[o],r)}},Inspector.prototype.addCombo=function(i,l,n){n=this.processOptions(n);var o=this;this.values[i]=l,this.tab_index++;var c=this.createWidget(i,"<span class='inputfield full inputcombo "+(n.disabled?"disabled":"")+"'></span>",n),d=(c.options=n).values||[];d.constructor===Function&&(d=n.values());var t="<select tabIndex='"+this.tab_index+"' "+(n.disabled?"disabled":"")+" class='"+(n.disabled?"disabled":"")+"'></select>";c.querySelector("span.inputcombo").innerHTML=t,e(d);var u=!1;function e(t,e){d=t=t||[],e&&(l=e);var i="",n=0;for(var o in d){var r=d[o],s=d.constructor===Array?n:o,a=d.constructor===Array?r:o;r&&r.title&&(a=r.title),i+="<option value='"+s+"' "+(r==l?" selected":"")+" data-index='"+s+"'>"+a+"</option>",n++}c.querySelector("select").innerHTML=i}return c.querySelector(".wcontent select").addEventListener("change",function(t){var e=t.target.value;l=d[e],u||Inspector.onWidgetChange.call(o,c,i,l,n)}),c.getValue=function(){return l},c.setValue=function(t,e){if(void 0!==t){l=t;var i=c.querySelector("select"),n=i.querySelectorAll("option"),o=-1;if(d.constructor===Array)o=d.indexOf(t);else{var r=0;for(var s in d){if(d[r]==t){o=r;break}r++}}if(-1!=o){for(var s in u=e,n){var a=n[s];a&&a.dataset&&(parseFloat(a.dataset.index)==o?(a.setAttribute("selected",!0),i.selectedIndex=o):a.removeAttribute("selected"))}u=!1}}},c.setOptionValues=e,this.append(c,n),this.processElement(c,n),c},Inspector.prototype.addComboButtons=function(o,t,r){r=this.processOptions(r),t=t||"";var s=this;this.values[o]=t;var e="";if(r.values)for(var i in r.values)e+="<button class='wcombobutton "+(t==r.values[i]?"selected":"")+"' data-name='options.values[i]'>"+r.values[i]+"</button>";var a=this.createWidget(o,e,r),n=a.querySelectorAll(".wcontent button");return LiteGUI.bind(n,"click",function(t){var e=t.target.innerHTML;s.values[o]=e;for(var i=a.querySelectorAll(".selected"),n=0;n<i.length;++n)i[n].classList.remove("selected");this.classList.add("selected"),Inspector.onWidgetChange.call(s,a,o,e,r)}),this.append(a,r),this.processElement(a,r),a},Inspector.prototype.addTags=function(i,t,n){n=this.processOptions(n),t=t||[];var o=this;this.values[i]=t;var e="<select>";if(n.values)for(var r in n.values)e+="<option>"+n.values[r]+"</option>";e+="</select><div class='wtagscontainer inputfield'></div>";var s=this.createWidget(i,"<span class='inputfield full'>"+e+"</span>",n);for(var r in s.tags={},n.value)a(n.value[r]);function a(t){if(!s.tags[t]){LiteGUI.trigger(s,"wbeforechange",s.tags),s.tags[t]=!0;var e=document.createElement("div");e.data=t,e.className="wtag",e.innerHTML=t+"<span class='close'>X</span>",e.querySelector(".close").addEventListener("click",function(t){var e=this.parentNode.data;delete s.tags[e],LiteGUI.remove(this.parentNode),LiteGUI.trigger(s,"wremoved",e),Inspector.onWidgetChange.call(o,s,i,s.tags,n)}),s.querySelector(".wtagscontainer").appendChild(e),o.values[i]=s.tags,n.callback&&n.callback.call(s,s.tags),LiteGUI.trigger(s,"wchange",s.tags),LiteGUI.trigger(s,"wadded",t),o.onchange&&o.onchange(i,s.tags,s)}}return s.querySelector(".wcontent select").addEventListener("change",function(t){a(t.target.value)}),this.append(s,n),this.processElement(s,n),s},Inspector.prototype.addList=function(o,r,c){c=this.processOptions(c);var s=this,t="";c.height&&(t="style='height: 100%; overflow: auto;'");var e="<ul class='lite-list' "+t+" tabIndex='"+this.tab_index+"'><ul>";this.tab_index++;var a=this.createWidget(o,"<span class='inputfield full "+(c.disabled?"disabled":"")+"' style='height: 100%;'>"+e+"</span>",c);a.querySelector(".info_content").style.height="100%";a.querySelector(".lite-list");var i=a.querySelector(".inputfield");i.style.height="100%",i.style.paddingBottom="0.2em";for(var n=a.querySelectorAll("ul"),l=0;l<n.length;++l){var d=n[l];d.addEventListener("focus",function(){document.addEventListener("keydown",u,!0)}),d.addEventListener("blur",function(){document.removeEventListener("keydown",u,!0)})}function u(t){var e=a.querySelector("li.selected");if(e){if(13==t.keyCode){if(!e)return;var i=r[e.dataset.pos];c.callback_dblclick&&c.callback_dblclick.call(s,i)}else if(40==t.keyCode){var n=e.nextSibling;n&&LiteGUI.trigger(n,"click"),e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded({block:"end",behavior:"smooth"})}else{if(38!=t.keyCode)return;var o=e.previousSibling;o&&LiteGUI.trigger(o,"click"),e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded({block:"end",behavior:"smooth"})}return t.preventDefault(),t.stopPropagation(),!0}}function h(t){if(c.multiselection)this.classList.toggle("selected");else{for(var e=a.querySelectorAll("li"),i=0;i<e.length;++i)e[i].classList.remove("selected");this.classList.add("selected")}var n=r[this.dataset.pos];Inspector.onWidgetChange.call(s,a,o,n,c),LiteGUI.trigger(a,"wadded",n)}function p(t){var e=r[this.dataset.pos];c.callback_dblclick&&c.callback_dblclick.call(s,e)}function f(t,e,i){var n=i,o=i;e=!!e;var r=null,s="";null!=t&&(t.constructor===String||t.constructor===Number||t.constructor===Boolean?o=String(t):t&&(o=t.content||t.title||t.name||i,r=t.style,t.icon&&(s="<img src='"+t.icon+"' class='icon' /> "),t.selected&&(e=!0)));var a=o;a=a.replace(/<(?:.|\n)*?>/gm,"");var l=document.createElement("li");return l.classList.add("item-"+LiteGUI.safeName(n)),e&&l.classList.add("selected"),l.dataset.name=a,l.dataset.pos=n,l.value=t,r&&l.setAttribute("style",r),l.innerHTML=s+o,l.addEventListener("click",h),c.callback_dblclick&&l.addEventListener("dblclick",p),l}return a.updateItems=function(t,e){e=e||c.selected;r=t;var i=this.querySelector("ul");if(i.innerHTML="",r)for(var n in r){var o=f(r[n],e,n);i.appendChild(o)}LiteGUI.bind(i.querySelectorAll("li"),"click",h)},a.addItem=function(t,e,i){if(r.constructor===Array){r.push(t);var n=this.querySelector("ul"),o=f(t,e);n.appendChild(o)}else console.error("cannot add item to list of object, only array")},a.removeItem=function(t){for(var e=a.querySelectorAll(".wcontent li"),i=0;i<e.length;i++)e[i].dataset.name==t&&LiteGUI.remove(e[i])},a.updateItems(r,c.selected),this.append(a,c),a.getSelected=function(){for(var t=[],e=this.querySelectorAll("ul li.selected"),i=0;i<e.length;++i)t.push(e[i].dataset.name);return t},a.getByIndex=function(t){return this.querySelectorAll("ul li")[t]},a.getIndex=a.getByIndex,a.selectIndex=function(t,e){for(var i=this.querySelectorAll("ul li"),n=0;n<i.length;++n){var o=i[n];n==t?o.classList.add("selected"):e||o.classList.remove("selected")}return i[t]},a.deselectIndex=function(t){var e=this.querySelectorAll("ul li")[t];return e&&e.classList.remove("selected"),e},a.scrollToIndex=function(t){var e=this.querySelectorAll("ul li")[t];e&&(this.scrollTop=e.offsetTop)},a.selectAll=function(){for(var t=this.querySelectorAll("ul li"),e=0;e<t.length;++e){var i=t[e];i.classList.contains("selected")||LiteGUI.trigger(i,"click")}},a.deselectAll=function(){for(var t=this.querySelectorAll("ul li"),e=0;e<t.length;++e){var i=t[e];i.classList.contains("selected")&&LiteGUI.trigger(i,"click")}},a.setValue=function(t){void 0!==t&&this.updateItems(t)},a.getNumberOfItems=function(){return this.querySelectorAll("ul li").length},a.filter=function(t,e){var i=this.querySelectorAll("ul li"),n=!1;if(t&&t.constructor===String){var o=t;e&&o.toLowerCase(),n=!0,t=function(t){return-1!=(e?t:t.toLowerCase()).indexOf(o)}}for(var r=0;r<i.length;++r){var s=i[r];if(t){var a=s.value;n&&null!=a&&a.constructor!==String&&(a=s.innerHTML),t(a,s,s.classList.contains("selected"))?s.style.display="":s.style.display="none"}else s.style.display=""}},a.selectByFilter=function(t){for(var e=this.querySelectorAll("ul li"),i=0;i<e.length;++i){var n=e[i],o=t(n.value,n,n.classList.contains("selected"));!0===o?n.classList.add("selected"):!1===o&&n.classList.remove("selected")}},c.height&&(a.scrollTop=0),this.processElement(a,c),a},Inspector.prototype.addButton=function(e,i,n){n=this.processOptions(n),i=n.button_text||i||"";var o=this,t="";null===e&&(t="single"),n.micro&&(t+=" micro");var r="";n.disabled&&(r="disabled='disabled'");var s=n.title||"",a=this.createWidget(e,"<button title='"+s+"' class='litebutton "+t+"' tabIndex='"+this.tab_index+"' "+r+">"+i+"</button>",n);this.tab_index++;var l=a.querySelector("button");return l.addEventListener("click",function(t){Inspector.onWidgetChange.call(o,a,e,this.innerHTML,n,!1,t),LiteGUI.trigger(l,"wclick",i)}),this.append(a,n),a.wclick=function(t){n.disabled||LiteGUI.bind(this,"wclick",t)},a.setValue=function(t){void 0!==t&&(l.innerHTML=t)},a.disable=function(){l.disabled=!0},a.enable=function(){l.disabled=!1},this.processElement(a,n),a},Inspector.prototype.addButtons=function(e,t,i){i=this.processOptions(i);var n=this,o="",r="calc( "+(100/(t=t||"").length).toFixed(3)+"% - 4px )",s="width:"+r+"; width: -moz-"+r+"; width: -webkit-"+r+"; margin: 2px;";if(t&&"object"==typeof t)for(var a in t){var l="";i.title&&i.title.constructor===Array&&(l=i.title[a]||""),o+="<button class='litebutton' title='"+l+"' tabIndex='"+this.tab_index+"' style='"+s+"'>"+t[a]+"</button>",this.tab_index++}var c=this.createWidget(e,o,i),d=c.querySelectorAll("button");for(a=0;a<d.length;++a){d[a].addEventListener("click",function(t){Inspector.onWidgetChange.call(n,c,e,this.innerHTML,i,null,t),LiteGUI.trigger(c,"wclick",this.innerHTML)})}return this.append(c,i),this.processElement(c,i),c},Inspector.prototype.addIcon=function(n,o,r){r=this.processOptions(r),o=o||"";var s=this,t=r.image,e=r.width||r.size||20,a=r.height||r.size||20,l=this.createWidget(n,"<span class='icon' "+(r.title?"title='"+r.title+"'":"")+" tabIndex='"+this.tab_index+"'></span>",r);this.tab_index++;var i=l.querySelector("span.wcontent"),c=l.querySelector("span.icon"),d=r.x||0;r.index&&(d=r.index*-e);var u=o?a:0;return l.style.minWidth=l.style.width=e+"px",l.style.margin="0 2px",l.style.padding="0",i.style.margin="0",i.style.padding="0",c.style.display="inline-block",c.style.cursor="pointer",c.style.width=e+"px",c.style.height=a+"px",c.style.backgroundImage="url('"+t+"')",c.style.backgroundPosition=d+"px "+u+"px",c.addEventListener("mousedown",function(t){t.preventDefault(),o=!o;var e=Inspector.onWidgetChange.call(s,l,n,o,r);LiteGUI.trigger(l,"wclick",o),void 0!==e&&(o=e);var i=o?a:0;c.style.backgroundPosition=d+"px "+i+"px",!1===r.toggle&&setTimeout(function(){c.style.backgroundPosition=d+"px 0px",o=!1},200)}),this.append(l,r),l.setValue=function(t,e){if(void 0!==t){var i=(o=t)?a:0;c.style.backgroundPosition=d+"px "+i+"px",e||Inspector.onWidgetChange.call(s,l,n,o,r)}},l.getValue=function(){return o},this.processElement(l,r),l},Inspector.prototype.addColor=function(i,t,n){n=this.processOptions(n),t=t||[0,0,0];var o=this;this.values[i]=t;var e="<input tabIndex='"+this.tab_index+"' id='colorpicker-"+i+"' class='color' value='"+t[0]+","+t[1]+","+t[2]+"' "+(n.disabled?"disabled":"")+"/>";this.tab_index++,n.show_rgb&&(e+="<span class='rgb-color'>"+Inspector.parseColor(t)+"</span>");var r=this.createWidget(i,e,n);this.append(r,n);var s=r.querySelector("input.color"),a=null;if(window.jscolor){if((a=new jscolor.color(s)).pickerFaceColor="#333",a.pickerBorderColor="black",a.pickerInsetColor="#222",a.rgb_intensity=1,n.disabled&&(a.pickerOnfocus=!1),t.constructor!==String&&t.length&&2<t.length){a.fromRGB(+t[0],+t[1],+t[2]),a.rgb_intensity=1}s.addEventListener("change",function(t){var e=r.querySelector(".rgb-color");e&&(e.innerHTML=LiteGUI.Inspector.parseColor(a.rgb))}),a.onImmediateChange=function(){var t=[a.rgb[0]*a.rgb_intensity,a.rgb[1]*a.rgb_intensity,a.rgb[2]*a.rgb_intensity],e=[t.concat(),a.toString()];LiteGUI.trigger(r,"wbeforechange",e),o.values[i]=t,n.callback&&n.callback.call(r,t.concat(),"#"+a.toString(),a),LiteGUI.trigger(r,"wchange",e),o.onchange&&o.onchange(i,t.concat(),r)},n.step=n.step||.01,n.dragger_class="nano";var l=new LiteGUI.Dragger(1,n);r.querySelector(".wcontent").appendChild(l.root),l.input.addEventListener("change",function(t){var e=parseFloat(this.value);a.rgb_intensity=e,a.onImmediateChange&&a.onImmediateChange()}),r.setValue=function(t,e){a.fromRGB(t[0],t[1],t[2]),e||LiteGUI.trigger(l.input,"change")},r.getValue=function(){return t}}else s.addEventListener("change",function(t){var e=r.querySelector(".rgb-color");e&&(e.innerHTML=LiteGUI.Inspector.parseColor(a.rgb))});return this.processElement(r,n),r},Inspector.prototype.addFile=function(n,t,o){o=this.processOptions(o),t=t||"";var r=this;this.values[n]=t;var s=this.createWidget(n,"<span class='inputfield full whidden' style='width: calc(100% - 26px)'><span class='filename'></span></span><button class='litebutton' style='width:20px; margin-left: 2px;'>...</button><input type='file' size='100' class='file' value='"+t+"'/>",o);s.querySelector(".wcontent").style.position="relative";var e=s.querySelector(".wcontent input"),a=s.querySelector(".wcontent .filename");return t&&(a.innerText=t.name),e.addEventListener("change",function(t){if(!t.target.files.length)return a.innerText="",void Inspector.onWidgetChange.call(r,s,n,null,o);var e=t.target.files[0];if(e.files=t.target.files,o.generate_url&&(e.url=URL.createObjectURL(t.target.files[0])),a.innerText=e.name,o.read_file){var i=new FileReader;i.onload=function(t){e.data=t.target.result,Inspector.onWidgetChange.call(r,s,n,e,o)},"binary"==o.read_file?i.readAsArrayBuffer(e):"data_url"==o.read_file?i.readAsDataURL(e):i.readAsText(e)}else Inspector.onWidgetChange.call(r,s,n,e,o)}),this.append(s,o),s},Inspector.prototype.addLine=function(e,t,i){i=this.processOptions(i),t=t||"";var n=this;this.values[e]=t;var o=this.createWidget(e,"<span class='line-editor'></span>",i);o.style.width="100%";var r=new LiteGUI.LineEditor(t,i);return o.querySelector("span.line-editor").appendChild(r),LiteGUI.bind(r,"change",function(t){LiteGUI.trigger(o,"wbeforechange",[t.target.value]),i.callback&&i.callback.call(o,t.target.value),LiteGUI.trigger(o,"wchange",[t.target.value]),Inspector.onWidgetChange.call(n,o,e,t.target.value,i)}),this.append(o,i),o},Inspector.prototype.addTree=function(t,e,i){i=this.processOptions(i),e=e||"";var n=this.createWidget(t,"<div class='wtree inputfield full'></div>",i),o=n.querySelector(".wtree");i.height&&(o.style.height="number"==typeof i.height?i.height+"px":i.height,o.style.overflow="auto");var r=n.tree=new LiteGUI.Tree(e,i.tree_options);return r.onItemSelected=function(t,e){i.callback&&i.callback.call(n,t,e)},o.appendChild(r.root),n.setValue=function(t){r.updateTree(t)},this.append(n,i),this.processElement(n,i),n},Inspector.prototype.addDataTree=function(t,e,i){i=this.processOptions(i),e=e||"";var n=this.createWidget(t,"<div class='wtree'></div>",i);return function t(e,i){for(var n in i){var o=document.createElement("div");o.className="treenode","object"==typeof i[n]?(o.innerHTML="<span class='itemname'>"+n+"</span><span class='itemcontent'></span>",t(o.querySelector(".itemcontent"),i[n])):o.innerHTML="<span class='itemname'>"+n+"</span><span class='itemvalue'>"+i[n]+"</span>",e.appendChild(o)}}(n.querySelector(".wtree"),e),this.append(n,i),n},Inspector.prototype.addArray=function(t,e,a){var l=this;if(e&&e.constructor===Array){var c=(a=this.processOptions(a)).data_type||"string",d=a.max_items||100,i=null;this.widgets_per_row=3,this.addInfo(t,null,{name_width:"100%",width:"100% - 160px"});var n=this.addString("length",e.length||"0",{width:100,callback:function(t){t=parseInt(t);e<0&&(e=0),e.length=t,o.call(i)}});return this.addButtons(null,["+","-"],{width:60,callback:function(t){"+"==t?e.length=e.length+1:0<e.length&&(e.length=e.length-1),n.setValue(e.length),o.call(i)}}),this.widgets_per_row=1,(i=this.addContainer(t,a)).value=e,o.call(i),i.setValue=function(t){this.value=t,o.call(i)},i.getValue=function(){return this.value=v},i}function o(){var t=this.value,e=Math.min(t.length,d);l.widgets_per_row+=1,this.innerHTML="";for(var i=0;i<e;++i){var n=null;void 0!==t[i]&&(n=t[i]);var o=document.createElement("div");o.className="array-row",o.innerHTML="<span class='row-index'>"+i+"</span><span class='row-cell'></span><button style='width: 30px;' class='litebutton single row-trash'><img src='imgs/mini-icon-trash.png'/></button>",this.appendChild(o);var r={widget_parent:o.querySelector(".row-cell"),callback:u.bind({value:this.value,index:i})};if(a.data_options)for(var s in a.data_options)r[s]=a.data_options[s];l.add(c,null,n,r)}--l.widgets_per_row}function u(t){this.value[this.index]=t,a.callback&&a.callback.call(i,this.value,this.index)}console.error("Inspector: Array widget value must be a valid array")},Inspector.prototype.addContainer=function(t,e){t&&t.constructor!==String&&console.warn("LiteGUI.Inspector.addContainer first parameter must be a string with the name");var i=this.startContainer(null,e);return this.endContainer(),i},Inspector.prototype.startContainer=function(t,e){e=this.processOptions(e);var i=document.createElement("DIV");return i.className="wcontainer",this.applyOptions(i,e),this.row_number=0,this.append(i),this.pushContainer(i),e.widgets_per_row&&(this.widgets_per_row=e.widgets_per_row),e.height&&(i.style.height=LiteGUI.sizeToCSS(e.height),i.style.overflow="auto"),i.refresh=function(){i.on_refresh&&i.on_refresh.call(this,i)},i},Inspector.prototype.endContainer=function(t,e){this.popContainer()},Inspector.prototype.addSection=function(t,i){i=this.processOptions(i);var e=this;this.current_section&&this.current_section.end();var n=document.createElement("DIV");n.className="wsection",t||(n.className+=" notitle"),i.className&&(n.className+=" "+i.className),i.collapsed&&(n.className+=" collapsed"),i.id&&(n.id=i.id),i.instance&&(n.instance=i.instance);var o="";return t&&(o+="<div class='wsectiontitle'>"+(i.no_collapse?"":"<span class='switch-section-button'></span>")+t+"</div>"),o+="<div class='wsectioncontent'></div>",n.innerHTML=o,n._last_container_stack=this._current_container_stack.concat(),this.root.appendChild(n),this.sections.push(n),n.sectiontitle=n.querySelector(".wsectiontitle"),t&&n.sectiontitle.addEventListener("click",function(t){if("button"!=t.target.localName){n.classList.toggle("collapsed");var e=n.querySelector(".wsectioncontent");e.style.display="none"===e.style.display?null:"none",i.callback&&i.callback.call(n,!n.classList.contains("collapsed"))}}),i.collapsed&&(n.querySelector(".wsectioncontent").style.display="none"),this.setCurrentSection(n),i.widgets_per_row&&(this.widgets_per_row=i.widgets_per_row),n.refresh=function(){n.on_refresh&&n.on_refresh.call(this,n)},n.end=function(){if(e.current_section==this){e._current_container_stack=this._last_container_stack,e._current_container=null;var t=this.querySelector(".wsectioncontent");t&&(e.isContainerInStack(t)&&e.popContainer(t),e.current_section=null)}},n},Inspector.prototype.setCurrentSection=function(t){if(this.current_section!=t){var e=(this.current_section=t).parentNode;this.popContainer(e);var i=t.querySelector(".wsectioncontent");this.pushContainer(i)}},Inspector.prototype.getCurrentSection=function(){for(var t=this._current_container_stack.length-1;0<=t;--t){var e=this._current_container_stack[t];if(e.classList.contains("wsectioncontent"))return e.parentNode}return null},Inspector.prototype.endCurrentSection=function(){this.current_section&&this.current_section.end()},Inspector.prototype.beginGroup=function(t,e){e=this.processOptions(e);var i=document.createElement("DIV");i.className="wgroup",t=t||"",i.innerHTML="<div class='wgroupheader "+(e.title?"wtitle":"")+"'><span class='switch-section-button'></span>"+t+"</div>",i.group=!0;var n=document.createElement("DIV");n.className="wgroupcontent",e.collapsed&&(n.style.display="none"),e.height&&(n.style.height=LiteGUI.sizeToCSS(e.height)),e.scrollable&&(n.style.overflow="auto"),i.appendChild(n);var o=e.collapsed||!1,r=i.querySelector(".wgroupheader");return o&&r.classList.add("collapsed"),r.addEventListener("click",function(t){var e=i.querySelector(".wgroupcontent").style;e.display="none"===e.display?"":"none",(o=!o)?r.classList.add("collapsed"):r.classList.remove("collapsed"),t.preventDefault()}),this.append(i,e),this.pushContainer(n),i},Inspector.prototype.endGroup=function(){for(;this.popContainer(),this._current_container&&!this._current_container.classList.contains("wgroupcontent"););},Inspector.prototype.addTitle=function(t,e){e=this.processOptions(e);var i=document.createElement("DIV"),n="<span class='wtitle'><span class='text'>"+t+"</span>";return e.help&&(n+="<span class='help'><div class='help-content'>"+e.help+"</div></span>"),n+="</span>",i.innerHTML=n,i.setValue=function(t){this.querySelector(".text").innerHTML=t},this.row_number=0,this.append(i,e),i},Inspector.prototype.scrollTo=function(t){var e=this.root.querySelector("#"+t);if(e){var i=this.root.offsetTop,n=e.offsetTop-i;this.root.parentNode.parentNode.scrollTop=n}},Inspector.prototype.processOptions=function(t){return"function"==typeof t&&(t={callback:t}),t||{}},Inspector.prototype.processElement=function(t,e){e.callback_update&&t.setValue&&(t.on_update=function(){this.setValue(e.callback_update.call(this),!0)})},Inspector.prototype.updateWidgets=function(){for(var t=0;t<this.widgets.length;++t){var e=this.widgets[t];e.on_update&&e.on_update(e)}},Inspector.parseColor=function(t){return"<span style='color: #FAA'>"+t[0].toFixed(2)+"</span>,<span style='color: #AFA'>"+t[1].toFixed(2)+"</span>,<span style='color: #AAF'>"+t[2].toFixed(2)+"</span>"},LiteGUI.Inspector=Inspector;